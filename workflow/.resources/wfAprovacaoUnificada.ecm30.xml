<list>
  <ProcessDefinition>
    <processDefinitionPK>
      <companyId>1</companyId>
      <processId>wfAprovacaoUnificada</processId>
    </processDefinitionPK>
    <processDescription>Aprovação Conforme Alçadas</processDescription>
    <instruction></instruction>
    <active>true</active>
    <publicProcess>true</publicProcess>
    <volumeId>Default</volumeId>
    <categoryId></categoryId>
    <managerEngineAllocationId>Papel</managerEngineAllocationId>
    <managerEngineAllocationConfiguration>&lt;AssignmentController&gt;&lt;Role&gt;admin&lt;/Role&gt;&lt;/AssignmentController&gt;</managerEngineAllocationConfiguration>
    <snapshotFrequency>0</snapshotFrequency>
    <baseDay>0</baseDay>
    <baseMonth>0</baseMonth>
    <periodId>Default</periodId>
    <uniqueCardVersion>false</uniqueCardVersion>
    <keyWord></keyWord>
    <complementsLevel>1</complementsLevel>
    <notifyRequisitionerComplements>true</notifyRequisitionerComplements>
    <notifyManagerComplements>false</notifyManagerComplements>
    <deadlineTime>0</deadlineTime>
    <warningDeadlineTime>0</warningDeadlineTime>
    <notifyAuthorityComplements>true</notifyAuthorityComplements>
  </ProcessDefinition>
  <ProcessDefinitionVersion>
    <processDefinitionVersionPK>
      <companyId>1</companyId>
      <processId>Aprovação Conforme Alçadas</processId>
      <version>119</version>
    </processDefinitionVersionPK>
    <versionDescription></versionDescription>
    <formId>7972140</formId>
    <editionMode>true</editionMode>
    <updateAttachmentsVersion>false</updateAttachmentsVersion>
    <controlsAttachmentsSecurity>false</controlsAttachmentsSecurity>
    <active>true</active>
    <blockedVersion>false</blockedVersion>
    <counterSign>false</counterSign>
    <openInstances>0</openInstances>
    <bpmnVersion>2</bpmnVersion>
    <processStates/>
    <favorito>false</favorito>
    <inheritFormSecurity>true</inheritFormSecurity>
    <mobileReady>false</mobileReady>
  </ProcessDefinitionVersion>
  <list>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>4</sequence>
      </processStatePK>
      <stateName>Início</stateName>
      <stateDescription>Início</stateDescription>
      <instruction></instruction>
      <deadlineTime>0</deadlineTime>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <engineAllocationConfiguration></engineAllocationConfiguration>
      <selectColleague>1</selectColleague>
      <initialState>true</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>3600</allowanceAuthorityTime>
      <frequenceAuthorityTime>3600</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>false</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>230</positionX>
      <positionY>80</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>10</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>5</sequence>
      </processStatePK>
      <stateName>Aprovador</stateName>
      <stateDescription>Aprovador</stateDescription>
      <instruction></instruction>
      <deadlineTime>28800</deadlineTime>
      <deadlineFieldName></deadlineFieldName>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId>meDefinirAprovadores</engineAllocationId>
      <selectColleague>1</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>3600</allowanceAuthorityTime>
      <frequenceAuthorityTime>3600</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>false</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>630</positionX>
      <positionY>69</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>80</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <executionType>0</executionType>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>13</sequence>
      </processStatePK>
      <stateName>Carregar Aprovadores</stateName>
      <stateDescription>Carregar Aprovadores</stateDescription>
      <instruction></instruction>
      <deadlineTime>0</deadlineTime>
      <deadlineFieldName></deadlineFieldName>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <selectColleague>1</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>false</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>0</allowanceAuthorityTime>
      <frequenceAuthorityTime>0</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>true</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>320</positionX>
      <positionY>62</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>82</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <executionType>1</executionType>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>17</sequence>
      </processStatePK>
      <stateName>Verificar Cadastro Alçadas Central Atendimento Accenture</stateName>
      <stateDescription>Verificar Cadastro Alçadas Central Atendimento Accenture</stateDescription>
      <instruction></instruction>
      <deadlineTime>0</deadlineTime>
      <deadlineFieldName></deadlineFieldName>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId>Executor Atividade</engineAllocationId>
      <engineAllocationConfiguration>&lt;AssignmentController&gt;&lt;BaseActivity&gt;4&lt;/BaseActivity&gt;&lt;Returns&gt;Last&lt;/Returns&gt;&lt;/AssignmentController&gt;</engineAllocationConfiguration>
      <selectColleague>1</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>3600</allowanceAuthorityTime>
      <frequenceAuthorityTime>3600</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>false</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>320</positionX>
      <positionY>220</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>80</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <executionType>0</executionType>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>27</sequence>
      </processStatePK>
      <stateName>Verificar falha de validação</stateName>
      <stateDescription>Verificar falha de validação</stateDescription>
      <instruction></instruction>
      <deadlineTime>120</deadlineTime>
      <deadlineFieldName></deadlineFieldName>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId>Usuário</engineAllocationId>
      <engineAllocationConfiguration>&lt;AssignmentController&gt;&lt;User&gt;imwn2dyhbuywfa0f1522083830483&lt;/User&gt;&lt;/AssignmentController&gt;</engineAllocationConfiguration>
      <selectColleague>1</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>3600</allowanceAuthorityTime>
      <frequenceAuthorityTime>3600</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>false</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>810</positionX>
      <positionY>248</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId>Default</periodId>
      <stateType>0</stateType>
      <bpmnType>80</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <executionType>0</executionType>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>35</sequence>
      </processStatePK>
      <stateName>Verificar Docto</stateName>
      <stateDescription>Verificar Docto</stateDescription>
      <instruction></instruction>
      <deadlineTime>0</deadlineTime>
      <deadlineFieldName></deadlineFieldName>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <selectColleague>1</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>false</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>0</allowanceAuthorityTime>
      <frequenceAuthorityTime>0</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>true</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>811</positionX>
      <positionY>70</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>82</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <noticeExpirationAuthorityTime>0</noticeExpirationAuthorityTime>
      <noticeExpirationRequisitionerTime>0</noticeExpirationRequisitionerTime>
      <noticeExpirationManagerTime>0</noticeExpirationManagerTime>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <executionType>1</executionType>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>16</sequence>
      </processStatePK>
      <stateName>Intermediário</stateName>
      <stateDescription>Intermediário</stateDescription>
      <instruction>Evento intermediário do processo</instruction>
      <deadlineTime>0</deadlineTime>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <engineAllocationConfiguration></engineAllocationConfiguration>
      <selectColleague>0</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>1</allowanceAuthorityTime>
      <frequenceAuthorityTime>1</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>true</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>400</positionX>
      <positionY>132</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>43</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <parentSequence>13</parentSequence>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>38</sequence>
      </processStatePK>
      <stateName>Intermediário</stateName>
      <stateDescription>Intermediário</stateDescription>
      <instruction>Evento intermediário do processo</instruction>
      <deadlineTime>0</deadlineTime>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <engineAllocationConfiguration></engineAllocationConfiguration>
      <selectColleague>0</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>true</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>1</allowanceAuthorityTime>
      <frequenceAuthorityTime>1</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>true</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>901</positionX>
      <positionY>120</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>0</stateType>
      <bpmnType>43</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
      <parentSequence>35</parentSequence>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>7</sequence>
      </processStatePK>
      <stateName>Nivel Final Atingido</stateName>
      <stateDescription>Nivel Final Atingido</stateDescription>
      <joint>false</joint>
      <initialState>false</initialState>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <automatic>true</automatic>
      <positionX>988</positionX>
      <positionY>41</positionY>
      <inhibitTransfer>false</inhibitTransfer>
      <stateType>1</stateType>
      <bpmnType>120</bpmnType>
      <signalId>0</signalId>
      <openInstances>0</openInstances>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>20</sequence>
      </processStatePK>
      <stateName>Validar</stateName>
      <stateDescription>Validar</stateDescription>
      <joint>false</joint>
      <initialState>false</initialState>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <automatic>true</automatic>
      <positionX>510</positionX>
      <positionY>53</positionY>
      <inhibitTransfer>false</inhibitTransfer>
      <stateType>1</stateType>
      <bpmnType>120</bpmnType>
      <signalId>0</signalId>
      <openInstances>0</openInstances>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
    </ProcessState>
    <ProcessState>
      <processStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>12</sequence>
      </processStatePK>
      <stateName>Fim</stateName>
      <stateDescription>Fim</stateDescription>
      <instruction>Esta atividade indica que o processo terminado e que não ocorrerá nenhum tipo de pós processamento.</instruction>
      <deadlineTime>0</deadlineTime>
      <joint>false</joint>
      <agreementPercentage>0</agreementPercentage>
      <engineAllocationId></engineAllocationId>
      <engineAllocationConfiguration></engineAllocationConfiguration>
      <selectColleague>0</selectColleague>
      <initialState>false</initialState>
      <notifyAuthorityDelay>false</notifyAuthorityDelay>
      <notifyRequisitionerDelay>false</notifyRequisitionerDelay>
      <allowanceAuthorityTime>0</allowanceAuthorityTime>
      <frequenceAuthorityTime>1</frequenceAuthorityTime>
      <allowanceRequisitionerTime>0</allowanceRequisitionerTime>
      <frequenceRequisitionerTime>0</frequenceRequisitionerTime>
      <transferAttachments>false</transferAttachments>
      <subProcessId></subProcessId>
      <formFolder>0</formFolder>
      <notifyAuthorityFollowUp>false</notifyAuthorityFollowUp>
      <notifyRequisitionerFollowUp>false</notifyRequisitionerFollowUp>
      <automatic>false</automatic>
      <positionX>1175</positionX>
      <positionY>81</positionY>
      <forecastedEffortType>0</forecastedEffortType>
      <forecastedEffort>0</forecastedEffort>
      <notifyManagerFollowUp>false</notifyManagerFollowUp>
      <notifyManagerDelay>false</notifyManagerDelay>
      <allowanceManagerTime>0</allowanceManagerTime>
      <frequenceManagerTime>0</frequenceManagerTime>
      <inhibitTransfer>false</inhibitTransfer>
      <periodId></periodId>
      <stateType>6</stateType>
      <bpmnType>68</bpmnType>
      <signalId>0</signalId>
      <counterSign>false</counterSign>
      <openInstances>0</openInstances>
      <destinationStates/>
      <digitalSignature>false</digitalSignature>
    </ProcessState>
  </list>
  <list>
    <ConditionProcessState>
      <conditionProcessStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <expressionOrder>1</expressionOrder>
        <version>119</version>
        <sequence>7</sequence>
      </conditionProcessStatePK>
      <condition>hAPI.getCardValue(&quot;seAprovado&quot;)==&quot;Reprovado&quot;&#xd;
</condition>
      <destinationSequenceId>12</destinationSequenceId>
      <conditionType>0</conditionType>
    </ConditionProcessState>
    <ConditionProcessState>
      <conditionProcessStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <expressionOrder>2</expressionOrder>
        <version>119</version>
        <sequence>7</sequence>
      </conditionProcessStatePK>
      <condition> verificaUltimoAprovador() == &quot;sim&quot; &amp;&amp; &#xd;
hAPI.getCardValue(&quot;seAprovado&quot;)==&quot;Aprovado&quot;</condition>
      <destinationSequenceId>12</destinationSequenceId>
      <conditionType>0</conditionType>
    </ConditionProcessState>
    <ConditionProcessState>
      <conditionProcessStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <expressionOrder>3</expressionOrder>
        <version>119</version>
        <sequence>7</sequence>
      </conditionProcessStatePK>
      <condition>verificaUltimoAprovador() == &quot;nao&quot; </condition>
      <destinationSequenceId>5</destinationSequenceId>
      <conditionType>0</conditionType>
    </ConditionProcessState>
    <ConditionProcessState>
      <conditionProcessStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <expressionOrder>4</expressionOrder>
        <version>119</version>
        <sequence>7</sequence>
      </conditionProcessStatePK>
      <condition>true || false</condition>
      <destinationSequenceId>27</destinationSequenceId>
      <conditionType>0</conditionType>
    </ConditionProcessState>
    <ConditionProcessState>
      <conditionProcessStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <expressionOrder>1</expressionOrder>
        <version>119</version>
        <sequence>20</sequence>
      </conditionProcessStatePK>
      <condition>verificaSeCargaAprovadores()==true</condition>
      <destinationSequenceId>5</destinationSequenceId>
      <conditionType>0</conditionType>
    </ConditionProcessState>
    <ConditionProcessState>
      <conditionProcessStatePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <expressionOrder>2</expressionOrder>
        <version>119</version>
        <sequence>20</sequence>
      </conditionProcessStatePK>
      <condition>true || false</condition>
      <destinationSequenceId>17</destinationSequenceId>
      <conditionType>0</conditionType>
    </ConditionProcessState>
  </list>
  <list>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>9</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>7</initialStateSequence>
      <finalStateSequence>5</finalStateSequence>
      <returnLabel></returnLabel>
      <name>Não - Aguardar proxima Aprovação</name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>11</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>7</initialStateSequence>
      <finalStateSequence>12</finalStateSequence>
      <returnLabel></returnLabel>
      <name>Sim</name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>14</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>4</initialStateSequence>
      <finalStateSequence>13</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>18</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>16</initialStateSequence>
      <finalStateSequence>17</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>19</linkSequence>
      </processLinkPK>
      <actionLabel>1 - Refazer Carga de Aprovadores</actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>17</initialStateSequence>
      <finalStateSequence>13</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>21</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>13</initialStateSequence>
      <finalStateSequence>20</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>22</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>20</initialStateSequence>
      <finalStateSequence>5</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>23</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>20</initialStateSequence>
      <finalStateSequence>17</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>true</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>28</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>7</initialStateSequence>
      <finalStateSequence>27</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>true</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>29</linkSequence>
      </processLinkPK>
      <actionLabel>2 - Encerrar WF de Aprovação</actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>27</initialStateSequence>
      <finalStateSequence>12</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>30</linkSequence>
      </processLinkPK>
      <actionLabel>1 - Nova Aprovação</actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>27</initialStateSequence>
      <finalStateSequence>5</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>31</linkSequence>
      </processLinkPK>
      <actionLabel>3 - Validar Novamente o Nível</actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>27</initialStateSequence>
      <finalStateSequence>7</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>34</linkSequence>
      </processLinkPK>
      <actionLabel>2 - Devolver p/Falha - Verificar Cadastro de Alçadas</actionLabel>
      <returnPermited>true</returnPermited>
      <initialStateSequence>27</initialStateSequence>
      <finalStateSequence>17</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>36</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>5</initialStateSequence>
      <finalStateSequence>35</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>37</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>35</initialStateSequence>
      <finalStateSequence>7</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>39</linkSequence>
      </processLinkPK>
      <actionLabel>5 - Verificar Docto</actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>27</initialStateSequence>
      <finalStateSequence>35</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>40</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>38</initialStateSequence>
      <finalStateSequence>27</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>41</linkSequence>
      </processLinkPK>
      <actionLabel></actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>27</initialStateSequence>
      <finalStateSequence>35</finalStateSequence>
      <returnLabel></returnLabel>
      <name>00:02</name>
      <automaticLink>true</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
    <ProcessLink>
      <processLinkPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <linkSequence>50</linkSequence>
      </processLinkPK>
      <actionLabel>Refazer Aprovadores</actionLabel>
      <returnPermited>false</returnPermited>
      <initialStateSequence>5</initialStateSequence>
      <finalStateSequence>13</finalStateSequence>
      <returnLabel></returnLabel>
      <name></name>
      <automaticLink>false</automaticLink>
      <defaultLink>false</defaultLink>
      <type>0</type>
    </ProcessLink>
  </list>
  <list/>
  <list>
    <WorkflowProcessEvent>
      <workflowProcessEventPK>
        <companyId>1</companyId>
        <eventId>servicetask13</eventId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
      </workflowProcessEventPK>
      <eventDescription>// Objeto para encapsular contexto e evitar variáveis globais&#xd;
var AprovacaoContext = {&#xd;
	// Flags de controle&#xd;
	lerFILIAIS: false,&#xd;
	lerCCUSTOS: false,&#xd;
	lerPA: false,&#xd;
	lerCV: false,&#xd;
	verCV: false,&#xd;
	verFILIAIS: false,&#xd;
	lerPA_VRVA: false,&#xd;
	&#xd;
	// Dados principais&#xd;
	CC: &apos;&apos;,&#xd;
	CC_Cod: &apos;&apos;,&#xd;
	filial: &apos;&apos;,&#xd;
	codFilial: &apos;&apos;,&#xd;
	usabilidade: &apos;&apos;,&#xd;
	cartaExcecao: &apos;&apos;,&#xd;
	valorSolicitado: &apos;&apos;,&#xd;
	valorCartaExcecao: &apos;&apos;,&#xd;
	operacao: &apos;&apos;,&#xd;
	CV: &apos;&apos;,&#xd;
	codCV: &apos;&apos;,&#xd;
	tipoSolicitacao: &apos;&apos;,&#xd;
	aprovadores: 0,&#xd;
	area: &apos;&apos;,&#xd;
	nomeFornecedor : &apos;&apos;,&#xd;
	cnpjFornecedor: &apos;&apos;,&#xd;
	&#xd;
	// Dados de processamento&#xd;
	usuarios: [],&#xd;
	nomesUsuarios: [], // Lista para controlar nomes de usuários já adicionados&#xd;
	origem: &apos;&apos;,&#xd;
	xSequencia: 0,&#xd;
	colleague: &apos;&apos;,&#xd;
	usuario: &apos;&apos;,&#xd;
	dsAprovadores: null&#xd;
};&#xd;
&#xd;
function servicetask13(attempt, message) {&#xd;
	var numChamado = getValue(&quot;WKNumProces&quot;);&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - INICIADO wf: &quot;+numChamado);&#xd;
&#xd;
	// ALTERAR USUARIO DE ABERTURA DO FLUXO DE ACORDO COM A ABERTURA DO FLUXO DE ORIGEM NO DATASET workflowProcess&#xd;
	var params = [];&#xd;
		params.push( DatasetFactory.createConstraint(&quot;workflowProcessPK.processInstanceId&quot;,numChamado,numChamado,ConstraintType.MUST) );&#xd;
	var dsProcesso = buscarDataset(&quot;workflowProcess&quot;, params);&#xd;
	var numChamadoOrigem = dsProcesso.getValue(0, &quot;sourceProcess&quot;);&#xd;
&#xd;
	var params = [];&#xd;
		params.push( DatasetFactory.createConstraint(&quot;workflowProcessPK.processInstanceId&quot;,numChamadoOrigem,numChamadoOrigem,ConstraintType.MUST) );&#xd;
	var dsProcessoOrigem = buscarDataset(&quot;workflowProcess&quot;, params);&#xd;
	if(dsProcessoOrigem.rowsCount &gt; 0){&#xd;
		// DATA DE CRIACAO PROCESSO PAI e CHAMADO ORIGEM&#xd;
		hAPI.setCardValue(&quot;numChamadoOrigem&quot; ,numChamadoOrigem );&#xd;
		hAPI.setCardValue(&quot;dtAberturaChamado&quot;,dsProcessoOrigem.getValue(0, &quot;startDateProcess&quot;) );&#xd;
&#xd;
		// USUARIO DE CRIACAO&#xd;
		var usuarioOrigem   = dsProcessoOrigem.getValue(0, &quot;requesterId&quot;);&#xd;
		if(usuarioOrigem != null &amp;&amp; usuarioOrigem != &quot;&quot;){&#xd;
			params = [];&#xd;
			params.push( DatasetFactory.createConstraint(&quot;colleaguePK.colleagueId&quot;,usuarioOrigem,usuarioOrigem,ConstraintType.MUST) );&#xd;
			var dsColleague = buscarDataset(&quot;colleague&quot;, params);&#xd;
			if(dsColleague.rowsCount == 0) {&#xd;
				throw &quot;### Cadastro não encontrado ou usuário bloqueado para &quot;+usuarioOrigem;   &#xd;
			} else {&#xd;
				hAPI.setCardValue(&quot;usrCriacao&quot;       ,usuarioOrigem );&#xd;
				hAPI.setCardValue(&quot;nomeCriacao&quot;      ,dsColleague.getValue(0, &quot;colleagueName&quot;) );&#xd;
			} &#xd;
		}&#xd;
	}&#xd;
&#xd;
	// PARAMETROS - usando contexto encapsulado&#xd;
	AprovacaoContext.CC                = String(hAPI.getCardValue(&quot;centroCusto&quot;			) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);	 &#xd;
	AprovacaoContext.CC_Cod            = String(hAPI.getCardValue(&quot;cdCentroCusto&quot;		) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.filial            = String(hAPI.getCardValue(&quot;filial&quot;				) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.codFilial         = String(hAPI.getCardValue(&quot;cdFilial&quot;			) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.cartaExcecao      = String(hAPI.getCardValue(&quot;cartaExcecao&quot;		) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.valorSolicitado   = String(hAPI.getCardValue(&quot;valorSolicitado&quot;		) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.valorCartaExcecao = String(hAPI.getCardValue(&quot;valorCartaExcecao&quot;	) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.operacao          = String(hAPI.getCardValue(&quot;operacao&quot;			) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;); &#xd;
	AprovacaoContext.CV                = String(hAPI.getCardValue(&quot;classeValor&quot;			) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.codCV             = String(hAPI.getCardValue(&quot;cdClasseValor&quot;		) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.tipoSolicitacao   = String(hAPI.getCardValue(&quot;tipoSolicitacao&quot;		) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.area              = String(hAPI.getCardValue(&quot;area&quot;				) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.aprovadores       = 0;&#xd;
	AprovacaoContext.usabilidade       = &apos;&apos;; // usada somente para PA - pegar usabilidade da filial&#xd;
	AprovacaoContext.nomeFornecedor    = String(hAPI.getCardValue(&quot;nomeFornecedor&quot;		) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;);&#xd;
	AprovacaoContext.cnpjFornecedor    = String(hAPI.getCardValue(&quot;cnpjFornecedor&quot;		) || &apos;&apos;).replace(&apos;&amp;nbsp;&apos;,&apos;&apos;).replace(/[^\d]+/g,&apos;&apos;); // somente numeros&#xd;
&#xd;
	// SEGURANCA FILIAL&#xd;
	if(AprovacaoContext.codFilial==&apos;&apos; || isNaN(parseInt(AprovacaoContext.codFilial))){&#xd;
		// RECUPERAR CODIGO&#xd;
		var xFilial = AprovacaoContext.filial.substring(0,AprovacaoContext.filial.indexOf(&apos;-&apos;) -1).trim();&#xd;
		hAPI.setCardValue(&apos;cdFilial&apos;,xFilial);&#xd;
		AprovacaoContext.codFilial=xFilial;&#xd;
&#xd;
	} else if(AprovacaoContext.filial==&apos;&apos; || AprovacaoContext.filial==null){&#xd;
		// RECUPERAR FILTRO&#xd;
		params = [];&#xd;
		params.push( DatasetFactory.createConstraint(&quot;CODIGO&quot;,AprovacaoContext.codFilial,AprovacaoContext.codFilial,ConstraintType.MUST) );&#xd;
		var dsFilial = buscarDataset(&quot;ds_Filiais&quot;, params);&#xd;
		if(dsFilial.rowsCount &gt;0) {&#xd;
			AprovacaoContext.filial = dsFilial.getValue(0, &quot;FILTRO&quot;);&#xd;
			hAPI.setCardValue(&apos;filial&apos;,AprovacaoContext.filial);&#xd;
		}&#xd;
	}&#xd;
&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - PARAMETROS&quot;);&#xd;
	log.dir(AprovacaoContext.nomeFornecedor);&#xd;
	log.dir(AprovacaoContext.CC);&#xd;
	log.dir(AprovacaoContext.CC_Cod);&#xd;
	log.dir(AprovacaoContext.filial);&#xd;
	log.dir(AprovacaoContext.codFilial);&#xd;
	log.dir(AprovacaoContext.cartaExcecao);&#xd;
	log.dir(AprovacaoContext.valorSolicitado);&#xd;
	log.dir(AprovacaoContext.valorCartaExcecao);&#xd;
	log.dir(AprovacaoContext.operacao);&#xd;
	log.dir(AprovacaoContext.CV);&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - PARAMETROS fim&quot;);&#xd;
&#xd;
	// CLASSE DE VALOR&#xd;
	if(AprovacaoContext.codCV== &apos;&apos;)&#xd;
		if(AprovacaoContext.CV != null &amp;&amp; AprovacaoContext.CV != &quot;&quot;){&#xd;
			AprovacaoContext.codCV = AprovacaoContext.CV.split(&apos; - &apos;)[0];&#xd;
			if(AprovacaoContext.codCV == null || AprovacaoContext.codCV == &quot;&quot;)&#xd;
				throw &quot;### Falha na leitura da classe de valor. Favor abrir chamado no ISM.&quot;;&#xd;
		} &#xd;
&#xd;
	// SEGURANCA CODIGO CENTRO DE CUSTO 90010379 - DIRETORIA HOSPITALAR (OPERACOES)&#xd;
	// CENTRO DE CUSTO PODE VIR UNICO OU COM VARIOS CENTROS DE CUSTOS SEPARADOS POR VIRGULA&#xd;
	AprovacaoContext.lerCCUSTOS = true;&#xd;
	try {&#xd;
		if(AprovacaoContext.CC_Cod==&apos;&apos; || isNaN(parseInt(AprovacaoContext.CC_Cod))) {&#xd;
			var xCCusto = AprovacaoContext.CC;&#xd;
			xCCusto = hAPI.getCardValue(&apos;centroCusto&apos;).substring(0,xCCusto.indexOf(&apos;-&apos;) -1).trim();&#xd;
			AprovacaoContext.CC_Cod = xCCusto;&#xd;
		}&#xd;
&#xd;
		if (AprovacaoContext.CC.indexOf(&quot;,&quot;) != -1)&#xd;
			AprovacaoContext.CC = AprovacaoContext.CC.split(&quot;,&quot;);&#xd;
		else {&#xd;
			if(AprovacaoContext.CC.indexOf(&quot;-&quot;) &lt;0) AprovacaoContext.CC=AprovacaoContext.CC_Cod+&apos; - &apos;+AprovacaoContext.CC; // SE SEM O CODIGO NO CENTRO DE CUSTO CARREGAR CONF CC_Cod&#xd;
&#xd;
			// 11050201 - LINHA DE CUIDADOS&#xd;
			AprovacaoContext.CC = [AprovacaoContext.CC]; &#xd;
		}&#xd;
	} catch (e) {&#xd;
		AprovacaoContext.lerCCUSTOS = false;&#xd;
	}&#xd;
&#xd;
	// SE VALOR SOLICITADO VIER ENTRE PARENTESIS (VALOR NEGATIVO) REMOVER OS PARENTESIS&#xd;
	if(AprovacaoContext.valorSolicitado.indexOf(&apos;(&apos;) &gt;= 0 &amp;&amp; AprovacaoContext.valorSolicitado.indexOf(&apos;)&apos;) &gt;= 0){&#xd;
		AprovacaoContext.valorSolicitado = AprovacaoContext.valorSolicitado.replace(&apos;(&apos;, &apos;&apos;).replace(&apos;)&apos;, &apos;&apos;);&#xd;
		// if(AprovacaoContext.valorSolicitado &lt;0)&#xd;
		//	AprovacaoContext.valorSolicitado = AprovacaoContext.valorSolicitado * -1; // CONVERTER PARA NEGATIVO&#xd;
	} &#xd;
&#xd;
	// TRANSFORMAR VALOR CARTA EXCECAO - R$ 33.000,00&#xd;
	AprovacaoContext.valorCartaExcecao = parseValorMonetario(AprovacaoContext.valorCartaExcecao);&#xd;
&#xd;
	// SEGURANCA CARTA DE EXCECAO&#xd;
	AprovacaoContext.cartaExcecao = isTrue(AprovacaoContext.cartaExcecao) ? &apos;Sim&apos; : &apos;Não&apos;;&#xd;
	hAPI.setCardValue(&quot;cartaExcecao&quot;, AprovacaoContext.cartaExcecao);&#xd;
&#xd;
	// VALOR DA SOLICITACAO  &#xd;
	var valorCarta = hAPI.getCardValue(&quot;valorCartaExcecao&quot;);&#xd;
	if(valorCarta==&apos;&apos; || valorCarta==null)&#xd;
		valorCarta = AprovacaoContext.valorSolicitado;&#xd;
&#xd;
	// SE CARTA DE EXCESSAO TROCAR VALOR PELO VALOR DA CARTA&#xd;
	if(AprovacaoContext.cartaExcecao == &apos;S&apos; || AprovacaoContext.cartaExcecao == &apos;on&apos; || AprovacaoContext.cartaExcecao == &quot;Sim&quot; || AprovacaoContext.cartaExcecao==&apos;sim&apos; )&#xd;
		AprovacaoContext.valorSolicitado = valorCarta;&#xd;
&#xd;
	// FORMATAR VALOR SOLICITADO&#xd;
	var moeda = getMoeda(AprovacaoContext.valorSolicitado);&#xd;
	AprovacaoContext.valorSolicitado = parseValorMonetario(AprovacaoContext.valorSolicitado);&#xd;
&#xd;
	if (isNaN(AprovacaoContext.valorSolicitado) || AprovacaoContext.valorSolicitado === 0)&#xd;
		throw &quot;### Valor solicitado invalido |&quot;+AprovacaoContext.valorSolicitado+&apos;|&apos;+hAPI.getCardValue( &quot;valorSolicitado&quot; )+&apos;|&apos;+hAPI.getCardValue( &quot;valorCartaExcecao&quot; );&#xd;
&#xd;
	// VERIFICA SE O VALOR ESTÁ EM MOEDA ESTRANGEIRA&#xd;
	if (moeda !== &quot;Real&quot;) {&#xd;
		var cotacao = valorPadrao(moeda);&#xd;
		AprovacaoContext.valorSolicitado = AprovacaoContext.valorSolicitado * cotacao;&#xd;
		hAPI.setCardValue(&quot;cotacaoMOEDA&quot;, &apos;&apos;+cotacao);&#xd;
	} else {&#xd;
		hAPI.setCardValue(&quot;cotacaoMOEDA&quot;, &apos;1.00&apos;);&#xd;
	}&#xd;
&#xd;
	// CAMPOS OBRIGATORIOS&#xd;
	var xmsg=[];&#xd;
&#xd;
	// VALOR PADRAO PARA CARTA DE EXCECAO&#xd;
	if(AprovacaoContext.cartaExcecao == null || AprovacaoContext.cartaExcecao == &quot;&quot;)&#xd;
		AprovacaoContext.cartaExcecao = &quot;N&quot;;&#xd;
&#xd;
    // &#xd;
	AprovacaoContext.xSequencia = 0;&#xd;
	AprovacaoContext.usuarios   = [];&#xd;
	AprovacaoContext.origem     = hAPI.getCardValue(&quot;numChamadoOrigem&quot;);&#xd;
	var atual  = hAPI.getCardValue(&quot;numChamado&quot;);&#xd;
	&#xd;
	// O PRIMEIRO APROVADOR FAZ TRATAMENTO PARA ADIANTAMENTO CONF REGRAS DE REEMBOLSO&#xd;
	// ATUALMENTE A CONSULTA AO SUPERIOR IMEDIATO ESTA SENDO FEITA ATRAVES DO DATASET DA SENIOR PELO NOME DO PRIMEIRO APROVADOR&#xd;
	var primeiroAPROVADOR = &apos;&apos;;&#xd;
&#xd;
	// VERIFICAR SE EXISTE OUTROS SUBPROCESSOS DE APROVACAO PARA O PROCESSO PAI E NAO CONSIDERAR AS APROVACOES JA INSERIDAS E QUE O STATUS SEJA IGUAL A &quot;Aprovado&quot;&#xd;
	// EXCETO MEDICAO e REEMBOLSO/ADIANTAMENTO QUE DEVEM APROVAR NOVAMENTE&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - DS_ALCADAS_EXECUTADAS &quot;+AprovacaoContext.operacao);&#xd;
	if(AprovacaoContext.operacao !=&apos;Solicitação de Medição de Contrato&apos; &amp;&amp; &#xd;
	   AprovacaoContext.operacao !=&apos;Solicitação de Reembolso ou Adiantamento&apos;){&#xd;
		var params = new Array();&#xd;
		params.push( DatasetFactory.createConstraint(&quot;processoPai&quot;,AprovacaoContext.origem,atual,ConstraintType.MUST) );&#xd;
		var dsExecutados      = buscarDataset(&quot;DS_ALCADAS_EXECUTADAS&quot;, params);&#xd;
		if(dsExecutados.rowsCount &gt; 0)&#xd;
			for (var i1 = 0; i1 &lt; dsExecutados.rowsCount; i1++) {&#xd;
				AprovacaoContext.colleague  = &apos;&apos;+dsExecutados.getValue(i1, &quot;apvLogin&quot; );&#xd;
				var status = &apos;&apos;+dsExecutados.getValue(i1, &quot;apvStatus&quot;);&#xd;
				&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - DS_ALCADAS_EXECUTADAS-colleague &quot;+AprovacaoContext.colleague);&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - DS_ALCADAS_EXECUTADAS-usuarios. &quot;+AprovacaoContext.usuarios );&#xd;
				&#xd;
				if(status==&apos;Aprovado&apos; &amp;&amp; AprovacaoContext.colleague !=null ){&#xd;
					AprovacaoContext.usuarios.push(AprovacaoContext.colleague);&#xd;
				}&#xd;
			}&#xd;
		&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - DS_ALCADAS_EXECUTADAS usuarios&quot;);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - DS_ALCADAS_EXECUTADAS-usuarios. &quot;+AprovacaoContext.usuarios );&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - operacao : &quot;+AprovacaoContext.operacao);&#xd;
	}&#xd;
&#xd;
	// SE OPERACAO = Solicitação de Reembolso ou Adiantamento&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - operacao : &quot;+AprovacaoContext.operacao);&#xd;
	if(AprovacaoContext.operacao==&apos;Solicitação de Reembolso ou Adiantamento&apos;) {&#xd;
		alcadasReembolso();&#xd;
	} else {&#xd;
		alcadasPadrao();&#xd;
	}&#xd;
&#xd;
	// APROVADORES NAO LOCALIZADOS&#xd;
	if(AprovacaoContext.usuarios.length&lt;=0){&#xd;
		throw &apos;### Atenção: Não consigo localizar os aprovadores conforme parametros. Favor acionar o suporte&apos;;&#xd;
	}&#xd;
&#xd;
	// FINALZADO&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - FINALIZADO&quot;);&#xd;
}&#xd;
&#xd;
// FUNCAO PARA ALCADAS PADRAO&#xd;
function alcadasPadrao(){&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - alcadasPadrao()&quot;);&#xd;
	// CONTROLE DE FILIAIS - EXCETO PARA OS CENTROS DE CUSTOS ABAIXO&#xd;
	AprovacaoContext.lerFILIAIS = true;&#xd;
	for (var i = 0; i &lt; AprovacaoContext.CC.length; i++) {&#xd;
		var centroCusto = AprovacaoContext.CC[i].toUpperCase();&#xd;
		if (centroCusto.indexOf(&quot;NOVOS NEGÓCIOS&quot;             ) != -1 || centroCusto.indexOf(&quot;NOVOS NEGÓCIOS JURÍDICO&quot; ) != -1 || &#xd;
			centroCusto.indexOf(&quot;NOVOS NEGOCIOS&quot;             ) != -1 || centroCusto.indexOf(&quot;NOVOS NEGOCIOS JURIDICO&quot; ) != -1 ||&#xd;
			centroCusto.indexOf(&quot;TRIBUTARIO&quot;                 ) != -1 || &#xd;
			centroCusto.indexOf(&quot;RECEBIMENTO FISCAL&quot;         ) != -1 ||&#xd;
			centroCusto.indexOf(&quot;ADMINISTRACAO DE PESSOAL&quot;   ) != -1 || &#xd;
			centroCusto.indexOf(&quot;DISPENSACAO DE MEDICAMENTOS&quot;) != -1 || &#xd;
			centroCusto.indexOf(&quot;FOLHA DE PAGAMENTO&quot;         ) != -1  &#xd;
		){&#xd;
			AprovacaoContext.lerFILIAIS = false;&#xd;
			break;&#xd;
		}&#xd;
	}&#xd;
	// CONTROLE DE FILIAIS - dataset EXCECAO&#xd;
	var params = new Array();&#xd;
		params.push( DatasetFactory.createConstraint(&quot;CC&quot;,AprovacaoContext.CC_Cod,AprovacaoContext.CC_Cod,ConstraintType.MUST) );&#xd;
	var dsCC = buscarDataset(&quot;DS_ALCADAS_UNIFICADAS_EXCECAO&quot;, params);&#xd;
	if(dsCC.rowsCount &gt; 0)&#xd;
		AprovacaoContext.lerFILIAIS = false;&#xd;
&#xd;
	// VERIFICA SE APROVACAO POR CLASSE DE VALOR FOI INFORMADA COM O CAMPO CLASSE DE VALOR&#xd;
	if(AprovacaoContext.codCV!=null &amp;&amp; AprovacaoContext.codCV!=&apos;&apos;){&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - codCV: &quot;+AprovacaoContext.codCV);&#xd;
		AprovacaoContext.verCV	    = true;&#xd;
		AprovacaoContext.lerCV	    = true;&#xd;
		AprovacaoContext.lerCCUSTOS = false; // NAO LER CENTRO DE CUSTOS&#xd;
		AprovacaoContext.lerFILIAIS = false; // NAO LER FILIAIS&#xd;
		AprovacaoContext.lerPA	    = false; // NAO LER PAGAMENTO ANTECIPADO&#xd;
		AprovacaoContext.lerPA_VRVA = false; // NAO LER PAGAMENTO ANTECIPADO VR/VA&#xd;
	} else {&#xd;
		AprovacaoContext.verCV      = false;&#xd;
		AprovacaoContext.lerCV      = false;&#xd;
		AprovacaoContext.lerCCUSTOS = true;&#xd;
		AprovacaoContext.lerPA      = false; // NAO LER PAGAMENTO ANTECIPADO&#xd;
		AprovacaoContext.lerPA_VRVA = false; // NAO LER PAGAMENTO ANTECIPADO VR/VA&#xd;
	}&#xd;
&#xd;
	// VERIFICA SE APROVACAO FOR OPERACACAO PA - PAGAMENTO ANTECIPADO&#xd;
	if(AprovacaoContext.operacao.toLowerCase()==&apos;pa&apos; || &#xd;
	   AprovacaoContext.operacao.toLowerCase()==&apos;pagamento antecipado&apos; ||&#xd;
	   AprovacaoContext.operacao.toLowerCase()==&apos;pagamentos estrangeiros&apos;){&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - operacao: &quot;+AprovacaoContext.operacao);&#xd;
		AprovacaoContext.lerCV      = false;&#xd;
		AprovacaoContext.lerFILIAIS = false;&#xd;
		AprovacaoContext.lerCCUSTOS = false;&#xd;
		AprovacaoContext.lerPA      = true;&#xd;
		AprovacaoContext.lerPA_VRVA = false; // NAO LER PAGAMENTO ANTECIPADO VR/VA&#xd;
		if( isPA_VRVA()){&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - operacao PA_VRVA: &quot;+AprovacaoContext.operacao);&#xd;
			AprovacaoContext.lerPA      = false;&#xd;
			AprovacaoContext.lerPA_VRVA = true;&#xd;
		} else {&#xd;
			// SE FILIAL FOR INFORMADA CARREGAR USABILIDADE execeto se for PA_VRVA&#xd;
			if(AprovacaoContext.codFilial != null &amp;&amp; AprovacaoContext.codFilial != &apos;&apos;){&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - codFilial: &quot;+AprovacaoContext.codFilial);&#xd;
				var params = new Array();&#xd;
					params.push( DatasetFactory.createConstraint(&quot;CODIGO&quot;,AprovacaoContext.codFilial,AprovacaoContext.codFilial,ConstraintType.MUST) );&#xd;
				var dsFiliais = buscarDataset(&quot;ds_Filiais&quot;, params);&#xd;
				if(dsFiliais.rowsCount &gt; 0){&#xd;
					AprovacaoContext.usabilidade = dsFiliais.getValue(0, &quot;USABILIDADE&quot;) || &apos;&apos;;&#xd;
					if(AprovacaoContext.usabilidade==&apos;&apos;)&#xd;
						throw &apos;ou FALHA no Cadastro de Filiais porque o campo USABILIDADE não foi informado. Favor abrir chamado no ISM.&apos;;&#xd;
					else&#xd;
						log.info(&quot;### AprovacaoUnificada.serviceTask13 - usabilidade: &quot;+AprovacaoContext.usabilidade);&#xd;
				} else {&#xd;
					throw &quot;ou FALHA em buscar Filial: &quot;+AprovacaoContext.codFilial+&quot;. Favor abrir chamado no ISM.&quot;;&#xd;
				}&#xd;
			}&#xd;
		}&#xd;
&#xd;
	}&#xd;
&#xd;
	// SE APROVACAO FOR PAGAMENTO ANTECIPADO VR/VA - TODOS OS APROVADORES SAO NIVEL 1 E FILTRAR SOMENTE PELO NIVEL PA_VRVA&#xd;
	if( isPA_VRVA() ){&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - operacao PA_VRVA: &quot;+AprovacaoContext.operacao);&#xd;
		AprovacaoContext.lerCV      = false;&#xd;
		AprovacaoContext.lerFILIAIS = false;&#xd;
		AprovacaoContext.lerCCUSTOS = false;&#xd;
		AprovacaoContext.lerPA      = false;&#xd;
		AprovacaoContext.lerPA_VRVA = true;&#xd;
	}&#xd;
&#xd;
	// LEITURA CONFORME ALCADAS DE APROVACAO UNIFICADAS x GRUPOS DE APROVACAO (CENTRO DE CUSTO E FILIAL) &#xd;
	for (var iGrupo = 0; iGrupo &lt;=4; iGrupo++) {&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - LEITURA &quot;+iGrupo+&quot; - wf: &quot;+getValue(&quot;WKNumProces&quot;));&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - AprovacaoContext.lerCV: &quot;+AprovacaoContext.lerCV);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - AprovacaoContext.lerCCUSTOS: &quot;+AprovacaoContext.lerCCUSTOS);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - AprovacaoContext.lerFILIAIS: &quot;+AprovacaoContext.lerFILIAIS);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - AprovacaoContext.lerPA: &quot;+AprovacaoContext.lerPA);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - AprovacaoContext.lerPA_VRVA: &quot;+AprovacaoContext.lerPA_VRVA);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - LEITURA fim &quot;+iGrupo);&#xd;
		&#xd;
		var params = new Array();&#xd;
&#xd;
		// SE GRUPO 0 - CLASSE DE VALOR INFORMADA NAO TEM APROVACAO POR CENTRO DE CUSTO&#xd;
		if(iGrupo==0){&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - iGrupo: &quot;+iGrupo);&#xd;
			// SE lerCV FOR FALSE NAO LER CLASSE DE VALOR&#xd;
			if(!AprovacaoContext.lerCV)&#xd;
				continue;&#xd;
			&#xd;
			if(AprovacaoContext.codCV!=&apos;&apos;){&#xd;
				AprovacaoContext.verCV      = true;&#xd;
				AprovacaoContext.lerCCUSTOS = false;&#xd;
				AprovacaoContext.lerFILIAIS = false;&#xd;
				params.push( DatasetFactory.createConstraint(&quot;CV&quot;,AprovacaoContext.codCV,AprovacaoContext.codCV,ConstraintType.MUST) );&#xd;
			}&#xd;
		} &#xd;
		&#xd;
		else if(iGrupo==1){&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - iGrupo: &quot;+iGrupo);&#xd;
			// SE lerCCUSTOS FOR FALSE NAO LER CENTRO DE CUSTOS&#xd;
			if(!AprovacaoContext.lerCCUSTOS)&#xd;
				continue;	&#xd;
&#xd;
			params.push( DatasetFactory.createConstraint(&quot;CDCCUSTO&quot;,AprovacaoContext.CC_Cod,AprovacaoContext.CC_Cod,ConstraintType.MUST) );&#xd;
&#xd;
			// FAZER A LEITURA DE CADA CENTRO DE CUSTO INFORMADO NO CAMPO CENTRO DE CUSTO CC&#xd;
			// for (var iCC = 0; iCC &lt; CC.length; iCC++) &#xd;
			// params.push( DatasetFactory.createConstraint(&quot;CDCCUSTO&quot;,CC_Cod,CC_Cod,ConstraintType.MUST) );&#xd;
		 } &#xd;
		&#xd;
		else if(iGrupo==2){&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - iGrupo: &quot;+iGrupo);&#xd;
			// SE lerFILIAIS FOR FALSE NAO LER FILIAIS&#xd;
			if(!AprovacaoContext.lerFILIAIS)&#xd;
				continue;	&#xd;
&#xd;
			// GRUPO 2 - FILIAL&#xd;
			params.push( DatasetFactory.createConstraint(&quot;CDFILIAL&quot;,AprovacaoContext.codFilial ,AprovacaoContext.codFilial,ConstraintType.MUST) );&#xd;
&#xd;
		} &#xd;
		&#xd;
		else if(iGrupo==3){&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - iGrupo: &quot;+iGrupo);&#xd;
			// SE lerPA FOR FALSE NAO LER PAGAMENTO ANTECIPADO&#xd;
			if(!AprovacaoContext.lerPA)&#xd;
				continue;	&#xd;
&#xd;
			// GRUPO 3 - PA - PAGAMENTO ANTECIPADO&#xd;
			params.push( DatasetFactory.createConstraint(&quot;PA&quot;,&apos;sim&apos;,&apos;sim&apos;,ConstraintType.MUST) );&#xd;
		}&#xd;
&#xd;
		else if(iGrupo==4){&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - iGrupo: &quot;+iGrupo);&#xd;
			// SE lerPA_VRVA FOR FALSE NAO LER PAGAMENTO ANTECIPADO VR/VA&#xd;
			if(!AprovacaoContext.lerPA_VRVA)&#xd;
				continue;	&#xd;
&#xd;
			// GRUPO 4 - PA_VRVA - PAGAMENTO ANTECIPADO VR/VA&#xd;
			params.push( DatasetFactory.createConstraint(&quot;PA_VRVA&quot;,&apos;sim&apos;,&apos;sim&apos;,ConstraintType.MUST) );&#xd;
		}&#xd;
		&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - DS_ALCADAS_UNIFICADAS: &quot;+iGrupo);&#xd;
		log.dir(params);&#xd;
		&#xd;
		// CARREGAR SOMENTE SE TEM PARAMETROS&#xd;
		if(params.length&lt;=0)&#xd;
			continue;&#xd;
&#xd;
		// CARREGAR ALCADAS UNIFICADAS		&#xd;
        AprovacaoContext.dsAprovadores = buscarDataset(&quot;DS_ALCADAS_UNIFICADAS&quot;, params); &#xd;
        &#xd;
        // SE NAO RETORNAR VALOR VERIFICAR AINDA SE EXISTE ALCADA CONF FILIAL&#xd;
        // Adicionar verificação de rowsCount antes de acessar getValue(0, ...)&#xd;
        if(AprovacaoContext.dsAprovadores.rowsCount &gt; 0 &amp;&amp; AprovacaoContext.dsAprovadores.getValue(0,&quot;ERROR&quot;))&#xd;
                throw AprovacaoContext.dsAprovadores.getValue(0,&quot;ERROR&quot;);&#xd;
        &#xd;
		// SE POSSUIR CLASSE DE VALOR E NAO ENCONTRAR APROVADOR PARA A CLASSE FORCAR PARADA PQ APROVADOR PARA A CLASSE DE VALOR EH OBRIGATORIO&#xd;
		if(AprovacaoContext.verCV)&#xd;
			if(AprovacaoContext.dsAprovadores.rowsCount == 0)&#xd;
				throw &quot;### Aprovador para a classe de valor &quot;+AprovacaoContext.codCV+&quot; não encontrado. Favor acionar a Central de Atendimento e solicitar o cadastro do aprovador.&quot;;&#xd;
	&#xd;
		// CARREGAR OS APROVADORES&#xd;
		lerAPROVADORES(0);&#xd;
	}&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - alcadasPadrao()-Finalizado&quot;);&#xd;
}&#xd;
&#xd;
function lerAPROVADORES(qAPROVADORES){&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - lerAPROVADORES() &quot;+qAPROVADORES);&#xd;
	&#xd;
	// LIMITE DE APROVADORES CONF PARAMETRO qAPROVADORES&#xd;
	var limite = AprovacaoContext.dsAprovadores.rowsCount;&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - limite &quot;+limite);&#xd;
	&#xd;
	// GRAVAR APROVADORES NA TABELA targetAprovadores&#xd;
	var Compliance = false;&#xd;
	for (var iAPV= 0; iAPV &lt; limite; iAPV++) {&#xd;
&#xd;
		// SE APROVACAO SERA COM BASE NO MOVIMENTO COM OU SEM CARTA DE EXCECAO&#xd;
		var base=&apos;0&apos;;&#xd;
		if(AprovacaoContext.cartaExcecao == &quot;Sim&quot;) &#xd;
			base = AprovacaoContext.dsAprovadores.getValue(iAPV, &quot;vlrComCarta&quot;).replace(&apos;&amp;&amp;nbsp;&apos;, &apos;&apos;); // COM CARTA DE EXCECAO&#xd;
		else&#xd;
			base = AprovacaoContext.dsAprovadores.getValue(iAPV, &quot;vlrSemCarta&quot;).replace(&apos;&amp;&amp;nbsp;&apos;, &apos;&apos;); // SEM CARTA DE EXCECAO&#xd;
&#xd;
		if(base==null || base==&apos;null&apos; || base==&apos;&apos;){&#xd;
			throw &quot;### Valor base para aprovação não encontrado a- &quot;+base;&#xd;
		}&#xd;
			&#xd;
		base = base.toString();&#xd;
		base = replaceAll( base,&apos;R$&apos;,&apos;&apos;  );&#xd;
		base = replaceAll( base,&quot;.&quot;, &quot;&quot;  );&#xd;
		base = replaceAll( base,&quot;,&quot;, &quot;.&quot; );&#xd;
		base = parseFloat(base);&#xd;
		if(isNaN(base) || base &lt; 0){&#xd;
			throw &quot;### Valor base do aprovador invalido b- &quot;+base;&#xd;
		}&#xd;
&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - iAPV &quot;           +iAPV);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - valorSolicitado &quot;+AprovacaoContext.valorSolicitado);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - base &quot;           +base);&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - operacao &quot;       +AprovacaoContext.operacao);&#xd;
		&#xd;
		// VALOR SOLICITADO PODERA VIR NEGATIVO SE O REEMBOLSO CALCULAR VALOR A SER REESTITUIDO PARA A CIA&#xd;
		if(AprovacaoContext.valorSolicitado&lt;0)&#xd;
			AprovacaoContext.valorSolicitado = AprovacaoContext.valorSolicitado * -1;&#xd;
&#xd;
		// SE VALOR SOLICITADO FOR MAIOR QUE O VALOR TETO DO APROVADOR&#xd;
		// SE OPERACAO = Solicitação de Reembolso ou Adiantamento - Forcar os 2 primeiros aprovadores da classe de valor independente do valor solicitado&#xd;
		if(AprovacaoContext.valorSolicitado &gt;= base || AprovacaoContext.operacao==&apos;Solicitação de Reembolso ou Adiantamento&apos; || Compliance) {&#xd;
&#xd;
			// se operacao = Pagamento Antecipado validar usabilidade&#xd;
			if(AprovacaoContext.operacao.toLowerCase()==&apos;pa&apos; || AprovacaoContext.operacao.toLowerCase()==&apos;pagamento antecipado&apos;){&#xd;
				var usabilidadeAprovador = AprovacaoContext.dsAprovadores.getValue(iAPV, &quot;usabilidade&quot;) || &apos;&apos;;&#xd;
				&#xd;
				// Se usabilidade da filial estiver preenchida, verificar se consta na usabilidade do aprovador&#xd;
				if(AprovacaoContext.usabilidade &amp;&amp; AprovacaoContext.usabilidade.trim() !== &apos;&apos; &amp;&amp; usabilidadeAprovador.indexOf(AprovacaoContext.usabilidade) &lt; 0){&#xd;
					log.info(&quot;### AprovacaoUnificada.serviceTask13 - Usabilidade do aprovador (&quot; + usabilidadeAprovador + &quot;) não confere com a usabilidade da filial (&quot; + AprovacaoContext.usabilidade + &quot;). Ignorar aprovador&quot;);&#xd;
					continue; // IGNORAR APROVADOR&#xd;
				}&#xd;
			}&#xd;
&#xd;
			// PEGAR USUARIO E COLLEAGUE DO APROVADOR&#xd;
			AprovacaoContext.colleague = &apos;&apos;+AprovacaoContext.dsAprovadores.getValue(iAPV, &quot;apv_Usuario_Id&quot;);&#xd;
			if(AprovacaoContext.colleague==&apos;null&apos; || AprovacaoContext.colleague==&apos;&apos;) &#xd;
				AprovacaoContext.colleague = &apos;&apos;+AprovacaoContext.dsAprovadores.getValue(iAPV, &quot;matrGestor&quot;);&#xd;
&#xd;
			if(AprovacaoContext.colleague==null || AprovacaoContext.colleague==&apos;&apos;)&#xd;
				AprovacaoContext.colleague = &apos;integrador.fluig&apos;;&#xd;
&#xd;
			AprovacaoContext.usuario = &apos;&apos;+AprovacaoContext.dsAprovadores.getValue(iAPV, &quot;apv_Usuario&quot;);&#xd;
			if(AprovacaoContext.usuario==&apos;null&apos; || AprovacaoContext.usuario==&apos;&apos;)&#xd;
				AprovacaoContext.usuario = &apos;&apos;+AprovacaoContext.dsAprovadores.getValue(iAPV, &quot;gestor&quot;);&#xd;
&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - colleague &quot;+AprovacaoContext.colleague);&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - usuario.. &quot;+AprovacaoContext.usuario  );&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - usuarios. &quot;+AprovacaoContext.usuarios );&#xd;
			if(AprovacaoContext.colleague==null) &#xd;
				continue;&#xd;
&#xd;
			// VERIFICAR SE O USUARIO JA NAO FOI INSERIDO NA TABELA targetAprovadores&#xd;
			if(AprovacaoContext.usuarios.indexOf(AprovacaoContext.colleague) == -1){&#xd;
&#xd;
				// VERIFICAR Compliance E SE FOR TRUE / USUARIO APROVADOR x FORNECEDOR NAO PODE TER APROVACAO - SUBIR O NIVEL PARA O PROXIMO APROVADOR&#xd;
				Compliance = isExcecaoCompliance(AprovacaoContext.colleague,AprovacaoContext.nomeFornecedor);&#xd;
				if(Compliance)&#xd;
					continue; // APROVADOR NAO ATENDE OS CRITERIOS DE Compliance - BUSCAR NOVO APROVADOR&#xd;
&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - usuario &quot;+AprovacaoContext.usuario+&quot; nao encontrado na lista de usuarios. Inserindo aprovador...&quot;);&#xd;
				AprovacaoContext.usuarios.push(AprovacaoContext.colleague);&#xd;
&#xd;
				// PEGAR LOGIN DO USUARIO CONFORME DATASET ALCADAS x COLLEAGUE&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - busca dados usuario &quot;+AprovacaoContext.usuario);&#xd;
				var paramColleague = new Array();&#xd;
					paramColleague.push( DatasetFactory.createConstraint(&apos;colleaguePK.companyId&apos;  ,1        ,1        ,ConstraintType.MUST) );&#xd;
					paramColleague.push( DatasetFactory.createConstraint(&apos;colleaguePK.colleagueId&apos;,AprovacaoContext.colleague,AprovacaoContext.colleague,ConstraintType.MUST) );&#xd;
				var dsColleague = buscarDataset(&quot;colleague&quot;, paramColleague);&#xd;
				if(dsColleague.rowsCount == 0)&#xd;
					throw &quot;### Cadastro não encontrado para o usuário &quot;+AprovacaoContext.usuario+&apos;/ de: &apos;+AprovacaoContext.usuarios;&#xd;
				else {&#xd;
					// SE TEM MAIS DE UM CADASTRO ATIVO PARA O USUARIO BLOQUEAR APROVACAO&#xd;
					if(dsColleague.rowsCount &gt; 1)&#xd;
						throw &quot;### Usuário &quot;+AprovacaoContext.usuario+&quot; possui mais de um cadastro ativo no fluig. Favor acionar o suporte&quot;;&#xd;
					else { &#xd;
						// SE USUARIO ESTIVER BLOQUEADO&#xd;
						if(dsColleague.getValue(0,&quot;active&quot;) ==&apos;false&apos; || dsColleague.getValue(0,&quot;active&quot;) ==false )&#xd;
							throw &quot;### Usuário &quot;+AprovacaoContext.usuario+&quot; está Bloqueado no Fluig. Favor acionar o suporte&quot;;&#xd;
						else {&#xd;
							// PEGAR ID DO USUARIO&#xd;
							AprovacaoContext.colleague = dsColleague.getValue(0, &quot;colleaguePK.colleagueId&quot;);&#xd;
							if(AprovacaoContext.colleague == null || AprovacaoContext.colleague == &quot;&quot;)&#xd;
								throw &quot;### Colleague não encontrado para o usuário &quot;+AprovacaoContext.usuario+&apos;. Favor acionar o suporte&apos;;&#xd;
						}&#xd;
					}&#xd;
				}&#xd;
				&#xd;
				// SE O APROVADOR FOR TBM O nomeFornecedor ADICIONAR APROVADOR FINANCEIRO&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - operacao: &quot;+AprovacaoContext.operacao);&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - nomeFornecedor: &quot;+AprovacaoContext.nomeFornecedor);&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - usuario: &quot;+AprovacaoContext.usuario);&#xd;
				if(isMesmaPessoa(AprovacaoContext.usuario, AprovacaoContext.nomeFornecedor) ){&#xd;
					log.info(&quot;### AprovacaoUnificada.serviceTask13 - Detectado que aprovador é o mesmo que nomeFornecedor: &quot; + AprovacaoContext.usuario );&#xd;
					log.info(&quot;### AprovacaoUnificada.serviceTask13 - Detectado que aprovador é o mesmo que nomeFornecedor: &quot; + AprovacaoContext.nomeFornecedor);&#xd;
					// buscar usuario do papel financeiro apv_FinanceiroAlcadas&#xd;
					var qPAPEL = &apos;apv_FinanceiroAlcadas&apos;;&#xd;
					var paramRoleId = [];&#xd;
						paramRoleId.push( DatasetFactory.createConstraint(&quot;workflowColleagueRolePK.roleId&quot;,qPAPEL,qPAPEL,ConstraintType.MUST) );&#xd;
					var resultDS = DatasetFactory.getDataset(&quot;workflowColleagueRole&quot;,null,paramRoleId,null);&#xd;
					if(resultDS.rowsCount&gt;0){&#xd;
						for (var iResult=0; iResult&lt;resultDS.rowsCount; iResult++) {&#xd;
							var novoAPV = resultDS.getValue(iResult,&quot;workflowColleagueRolePK.colleagueId&quot;);&#xd;
&#xd;
							// buscar nome do usuario em colleague&#xd;
							var paramsColleague = [];&#xd;
								paramsColleague.push( DatasetFactory.createConstraint(&quot;colleaguePK.companyId&quot;  ,1      ,1      ,ConstraintType.MUST) );&#xd;
								paramsColleague.push( DatasetFactory.createConstraint(&quot;colleaguePK.colleagueId&quot;,novoAPV,novoAPV,ConstraintType.MUST) );&#xd;
							var resultColleague = DatasetFactory.getDataset(&quot;colleague&quot;,null,paramsColleague,null);&#xd;
							var nomeAPV = resultColleague.getValue(0,&quot;colleagueName&quot;);&#xd;
							&#xd;
							AprovacaoContext.usuarios.push(nomeAPV);&#xd;
							log.info(&quot;### AprovacaoUnificada.serviceTask13 - colleagueName: &quot;+nomeAPV);&#xd;
&#xd;
							// TROCAR O APROVADOR SOLICITANTE PELO APROVADOR REGISTRADO EM apv_FinanceiroAlcadas&#xd;
							AprovacaoContext.colleague = novoAPV;&#xd;
						}&#xd;
					}&#xd;
				}&#xd;
&#xd;
				// CONTROLE DE USUARIO x USUARIOS APROVADORES&#xd;
				AprovacaoContext.usuarios.push(AprovacaoContext.usuario);&#xd;
&#xd;
				// INSERIR APROVADOR NA TABELA targetAprovadores&#xd;
				var newRow = new java.util.HashMap();&#xd;
					newRow.put(&quot;apvSequencia&quot;, &apos;&apos;+(AprovacaoContext.xSequencia+1)   );&#xd;
					newRow.put(&quot;apvLogin&quot;    , &apos;&apos;+AprovacaoContext.colleague        );&#xd;
					newRow.put(&quot;apvValorTeto&quot;, &apos;&apos;+base.toFixed(2)  );&#xd;
					newRow.put(&quot;apvStatus&quot;   , &quot;nao_confirmado&quot;    );&#xd;
	&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - targetAprovadores: &quot;+newRow);&#xd;
				try {&#xd;
					hAPI.addCardChild(&quot;targetAprovadores&quot;, newRow);&#xd;
					AprovacaoContext.xSequencia  +=1;&#xd;
					AprovacaoContext.aprovadores +=1; // SOMA DE TODOS OS APROVADORES ENCONTRADOS&#xd;
				} catch (e) {&#xd;
					throw &quot;### addCardChild - targetAprovadores falha. Favor abrir chamado no ISM.&quot;;&#xd;
				}&#xd;
&#xd;
				// REINICIAR Compliance&#xd;
				Compliance = false;&#xd;
&#xd;
				// QUANDO PROCESSO ORIGEM = jornadaFornecedorV360 PEGAR SOMENTE 2 APROVADORES&#xd;
				if(AprovacaoContext.operacao == &apos;jornadaFornecedorV360&apos;)&#xd;
					if(AprovacaoContext.aprovadores &gt;= 2)&#xd;
						break;&#xd;
&#xd;
				// MEDICAO DE CONTRATOS SOMENTE 1 APROVADOR&#xd;
				if(AprovacaoContext.operacao.toUpperCase()==&apos;SOLICITAÇÃO DE MEDIÇÃO DE CONTRATO&apos; ||&#xd;
				   AprovacaoContext.operacao.toUpperCase()==&apos;MEDIÇÃO DE CONTRATOS&apos;)&#xd;
					if(AprovacaoContext.aprovadores &gt;= 1)&#xd;
						break;&#xd;
&#xd;
				// SE OPERACAO = &apos;Cancelamento NFSe Tasy x OC Integra x Protheus&apos;&#xd;
				if(AprovacaoContext.operacao.toUpperCase()==&apos;Cancelamento NFSe Tasy x OC Integra x Protheus&apos;)&#xd;
					if(AprovacaoContext.aprovadores &gt;= 2)&#xd;
						break;&#xd;
				&#xd;
				// SE OPERACAO = &apos;Solicitação de Reembolso ou Adiantamento&apos;&#xd;
				if(AprovacaoContext.operacao.toUpperCase()==&apos;SOLICITAÇÃO DE REEMBOLSO OU ADIANTAMENTO&apos;)&#xd;
					if(AprovacaoContext.aprovadores &gt;= 2)&#xd;
						break;&#xd;
&#xd;
				// NUMERO MAXIMO DE APROVADORES CONF SOLICITADO EDGAR BUSINESS CONTROL&#xd;
				if(AprovacaoContext.aprovadores &gt;= 7)&#xd;
					break;&#xd;
			}&#xd;
		}&#xd;
	}&#xd;
&#xd;
	// NAO ENCONTROU USUARIO SUBSTITUTO PARA REGRA DE Compliance&#xd;
	if(Compliance){&#xd;
		var qPAPEL = &apos;apv_FinanceiroAlcadas&apos;;&#xd;
		var paramRoleId = [];&#xd;
			paramRoleId.push( DatasetFactory.createConstraint(&quot;workflowColleagueRolePK.roleId&quot;,qPAPEL,qPAPEL,ConstraintType.MUST) );&#xd;
		var resultDS = DatasetFactory.getDataset(&quot;workflowColleagueRole&quot;,null,paramRoleId,null);&#xd;
		if(resultDS.rowsCount&gt;0){&#xd;
			for (var iResult=0; iResult&lt;resultDS.rowsCount; iResult++) {&#xd;
				var novoAPV = resultDS.getValue(iResult,&quot;workflowColleagueRolePK.colleagueId&quot;);&#xd;
&#xd;
				// buscar nome do usuario em colleague&#xd;
				var paramsColleague = [];&#xd;
					paramsColleague.push( DatasetFactory.createConstraint(&quot;colleaguePK.companyId&quot;  ,1      ,1      ,ConstraintType.MUST) );&#xd;
					paramsColleague.push( DatasetFactory.createConstraint(&quot;colleaguePK.colleagueId&quot;,novoAPV,novoAPV,ConstraintType.MUST) );&#xd;
				var resultColleague = DatasetFactory.getDataset(&quot;colleague&quot;,null,paramsColleague,null);&#xd;
				var nomeAPV = resultColleague.getValue(0,&quot;colleagueName&quot;);&#xd;
				AprovacaoContext.usuarios.push(nomeAPV);&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - colleagueName: &quot;+nomeAPV);&#xd;
&#xd;
				// INSERIR APROVADOR NA TABELA targetAprovadores&#xd;
				var newRow = new java.util.HashMap();&#xd;
					newRow.put(&quot;apvSequencia&quot;, &apos;&apos;+(AprovacaoContext.xSequencia+1)   );&#xd;
					newRow.put(&quot;apvLogin&quot;    , &apos;&apos;+novoAPV);&#xd;
					newRow.put(&quot;apvValorTeto&quot;, &apos;&apos;+base.toFixed(2)  );&#xd;
					newRow.put(&quot;apvStatus&quot;   , &quot;nao_confirmado&quot;    );&#xd;
&#xd;
				try {&#xd;
					hAPI.addCardChild(&quot;targetAprovadores&quot;, newRow);&#xd;
					AprovacaoContext.xSequencia  +=1;&#xd;
					AprovacaoContext.aprovadores +=1; // SOMA DE TODOS OS APROVADORES ENCONTRADOS&#xd;
				} catch (e) {&#xd;
					throw &quot;### addCardChild - targetAprovadores falha aprovador financeiro. Favor abrir chamado no ISM.&quot;;&#xd;
				}&#xd;
			}&#xd;
		}&#xd;
	}&#xd;
&#xd;
	// VERIFICA SE CLASSE DE VALOR FOI INFORMADA&#xd;
	if(AprovacaoContext.codCV != null &amp;&amp; AprovacaoContext.codCV != &quot;&quot;)&#xd;
		// SE tipoSolicitacao NAO POSSUIR 2 APROVADORES PARA ADIANTAMENTO RETORNAR ERRO&#xd;
		if(AprovacaoContext.tipoSolicitacao == &apos;adiantamento&apos; &amp;&amp; AprovacaoContext.aprovadores &lt; 2)&#xd;
			throw &quot;### Atenção: Não foi possível localizar todos os aprovadores para o adiantamento. Necessário 2 aprovadores para a Classe de Valor. Favor acionar o suporte&quot;;&#xd;
&#xd;
	// FINALIZADA A LEITURA DO DATASET&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - lerAPROVADORES()-Finalizado&quot;);&#xd;
}&#xd;
&#xd;
// FUNCAO PARA TROCAR APROVADOR CONFORME EXCESSAO Compliance&#xd;
function isExcecaoCompliance(qUSER,qFORNECEDOR){&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isExcecaoCompliance()&quot;);&#xd;
	var isExcecao = false;&#xd;
&#xd;
	var user        = (qUSER || &apos;&apos;).toUpperCase();&#xd;
	var fornecedor  = (qFORNECEDOR || &apos;&apos;).toUpperCase();&#xd;
	var listaExcecao = {&#xd;
						nome		:	&quot;Luiz Felippe Quites Teixeira&quot;,&#xd;
						idUser		:	&quot;8d3dbb700c46490fb96e8175604d6ff6&quot;,&#xd;
						razaoSocial	:	&quot;Azevedo Sette Advogados&quot;,&#xd;
						CNPJ		:	&quot;65.174.088/0001-03&quot;&#xd;
					};&#xd;
&#xd;
	for(var key in listaExcecao){&#xd;
		if((listaExcecao[key].idUser || &apos;&apos;).toUpperCase() == user &amp;&amp; (listaExcecao[key].razaoSocial || &apos;&apos;).toUpperCase() == fornecedor){&#xd;
			isExcecao = true;&#xd;
			break;&#xd;
		}&#xd;
	}&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isExcecaoCompliance() - isExcecao: &quot;+isExcecao);&#xd;
	return isExcecao;&#xd;
}&#xd;
&#xd;
// FUNCAO PARA IDENTIFICAR PA_VRVA&#xd;
function isPA_VRVA(){&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isPA_VRVA()&quot;);&#xd;
	var isVRVA = false;&#xd;
	&#xd;
  	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isPA_VRVA() - CNPJ: &quot;+AprovacaoContext.cnpjFornecedor);&#xd;
	&#xd;
	// LISTA DE CNPJS QUE UTILIZAM VR/VA NO PAGAMENTO ANTECIPADO &#xd;
	var listaCNPJ = [ 	&#xd;
		{ nome: &apos;PLUXEE BENEFICIOS DO BRASIL&apos;,    cnpj: &apos;69034668000156&apos; },&#xd;
		{ nome: &apos;BENEFICIO FACIL SERVICOS LTDAE&apos;, cnpj: &apos;06353068000130&apos; }&#xd;
	];&#xd;
	&#xd;
	// VERIFICAR SE OPERACAO = PA - PAGAMENTO ANTECIPADO&#xd;
	if(	AprovacaoContext.operacao.toLowerCase()==&apos;pagamento antecipado vr_va&apos;   || &#xd;
		AprovacaoContext.operacao.toLowerCase()==&apos;pagamento antecipado&apos;         || &#xd;
		AprovacaoContext.operacao.toLowerCase()==&apos;pagamento antecipado - vr/va&apos; || &#xd;
		AprovacaoContext.operacao.toLowerCase()==&apos;pa_vrva&apos; 						){&#xd;
		// VERIFICAR SE CNPJ DO FORNECEDOR ESTA NA LISTA DE VR/VA&#xd;
		for(var i = 0; i &lt; listaCNPJ.length; i++){&#xd;
			if(listaCNPJ[i].cnpj == AprovacaoContext.cnpjFornecedor){&#xd;
				log.info(&quot;### AprovacaoUnificada.serviceTask13 - isPA_VRVA() - CNPJ encontrado na lista de VR/VA: &quot;+listaCNPJ[i].nome);&#xd;
				isVRVA = true;&#xd;
				break;&#xd;
			}&#xd;
		}&#xd;
	}&#xd;
	&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isPA_VRVA() - isVRVA: &quot;+isVRVA);&#xd;
	return isVRVA;&#xd;
}&#xd;
&#xd;
// FUNCAO PARA ALCADAS DE REEMBOLSO E/OU ADIANTAMENTO&#xd;
function alcadasReembolso()	{&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - alcadasReembolso()&quot;);&#xd;
	&#xd;
	// LEITURA CONFORME ALCADAS DE APROVACAO UNIFICADAS x GRUPOS DE APROVACAO (CENTRO DE CUSTO E FILIAL) &#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - DS_ALCADAS_UNIFICADAS: AR-Adiantamento/Reembolso&quot;);&#xd;
	var params = new Array();&#xd;
&#xd;
	if(AprovacaoContext.CV!=&apos;&apos;){&#xd;
		// CAPEX &#xd;
		// 	SE REEMBOLSO&#xd;
		//    LIDER DO PROJETO - primeiro aprovador da classe de valor&#xd;
		// 	SE ADIANTAMENTO&#xd;
		//    LIDER DO PROJETO - primeiro aprovador da classe de valor&#xd;
		//    GESTOR IMEDIATO  - segundo aprovador da classe de valor&#xd;
		// CLASSE DE VALOR&#xd;
		params.push( DatasetFactory.createConstraint(&quot;CV&quot;,AprovacaoContext.codCV,AprovacaoContext.codCV,ConstraintType.MUST) );&#xd;
&#xd;
	} else {&#xd;
		// OPEX&#xd;
		// 	SE REEMBOLSO&#xd;
		// 	SE ADIANTAMENTO&#xd;
		// 		SEMPRE 2 APROVADORES POR CENTRO DE CUSTO&#xd;
		params.push( DatasetFactory.createConstraint(&quot;AR&quot;      ,&apos;SIM&apos; ,&apos;SIM&apos;,ConstraintType.MUST) );&#xd;
		params.push( DatasetFactory.createConstraint(&quot;CDCCUSTO&quot;,AprovacaoContext.CC_Cod,AprovacaoContext.CC_Cod,ConstraintType.MUST) );&#xd;
	}&#xd;
	AprovacaoContext.dsAprovadores = buscarDataset(&quot;DS_ALCADAS_UNIFICADAS&quot;, params); &#xd;
	if(AprovacaoContext.dsAprovadores.rowsCount &gt; 0 &amp;&amp; AprovacaoContext.dsAprovadores.getValue(0,&quot;ERROR&quot;))&#xd;
		throw AprovacaoContext.dsAprovadores.getValue(0,&quot;ERROR&quot;);&#xd;
	&#xd;
	// SE POSSUIR CLASSE DE VALOR E NAO ENCONTRAR APROVADOR PARA A CLASSE FORCAR PARADA PQ APROVADOR PARA A CLASSE DE VALOR EH OBRIGATORIO&#xd;
	if(AprovacaoContext.codCV != null &amp;&amp; AprovacaoContext.codCV != &quot;&quot;){&#xd;
		if(AprovacaoContext.verCV &amp;&amp; AprovacaoContext.dsAprovadores.rowsCount == 0)&#xd;
			throw &quot;### Aprovador para a classe de valor &quot;+AprovacaoContext.codCV+&quot; não encontrado. Favor acionar a Controladoria para cadastro do aprovador&quot;;&#xd;
	} else {&#xd;
		// SE NAO POSSUIR CLASSE DE VALOR E NAO ENCONTRAR APROVADOR PARA O CENTRO DE CUSTO FORCAR LEITURA POR FILIAL&#xd;
		if(AprovacaoContext.dsAprovadores.rowsCount == 0){&#xd;
			log.info(&quot;### AprovacaoUnificada.serviceTask13 - alcadasReembolso() - CENTRO DE CUSTO NAO ENCONTRADO APROVADORES&quot;);&#xd;
			params = new Array();&#xd;
			params.push( DatasetFactory.createConstraint(&quot;AR&quot;      ,&apos;SIM&apos; ,&apos;SIM&apos;,ConstraintType.MUST) );&#xd;
			params.push( DatasetFactory.createConstraint(&quot;CDFILIAL&quot;,AprovacaoContext.codFilial ,AprovacaoContext.codFilial,ConstraintType.MUST) );&#xd;
			AprovacaoContext.dsAprovadores = buscarDataset(&quot;DS_ALCADAS_UNIFICADAS&quot;, params); &#xd;
			if(AprovacaoContext.dsAprovadores.rowsCount &gt; 0 &amp;&amp; AprovacaoContext.dsAprovadores.getValue(0,&quot;ERROR&quot;))&#xd;
				throw AprovacaoContext.dsAprovadores.getValue(0,&quot;ERROR&quot;);&#xd;
&#xd;
			if(AprovacaoContext.dsAprovadores.rowsCount == 0)&#xd;
				throw &quot;### Aprovador para a Centro de Custo ou FILIAL/AR &quot;+AprovacaoContext.codFilial+&quot; não encontrado. Favor acionar a Controladoria para cadastro do aprovador&quot;;&#xd;
		}&#xd;
	}&#xd;
&#xd;
	// CARREGAR OS APROVADORES&#xd;
	lerAPROVADORES(1);&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - alcadasReembolso()-Finalizado&quot;);&#xd;
}&#xd;
&#xd;
// FUNCAO PARA VERIFICAR SE DUAS PESSOAS SAO A MESMA COMPARANDO NOMES DE FORMA INTELIGENTE&#xd;
function isMesmaPessoa(nome1, nome2) {&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isMesmaPessoa()&quot;);&#xd;
	if (!nome1 || !nome2) return false;&#xd;
	&#xd;
	// Normalizar os nomes: converter para lowercase &#xd;
	var n1 = nome1.toString().toLowerCase().trim();&#xd;
	var n2 = nome2.toString().toLowerCase().trim();&#xd;
	&#xd;
	// Se forem exatamente iguais após normalização&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isMesmaPessoa() - n1/n2: &quot;+n1+&apos;/&apos;+n2);&#xd;
	if (n1 == n2) return true;&#xd;
	&#xd;
	// Dividir os nomes em palavras (primeiro nome, sobrenomes)&#xd;
	var palavras1 = n1.split(&apos; &apos;);&#xd;
	var palavras2 = n2.split(&apos; &apos;);&#xd;
	&#xd;
	// Filtrar palavras vazias&#xd;
	var temp1 = [];&#xd;
	for (var k = 0; k &lt; palavras1.length; k++) {&#xd;
		if (palavras1[k].length &gt; 0) {&#xd;
			temp1.push(palavras1[k]);&#xd;
		}&#xd;
	}&#xd;
	palavras1 = temp1;&#xd;
	&#xd;
	var temp2 = [];&#xd;
	for (var l = 0; l &lt; palavras2.length; l++) {&#xd;
		if (palavras2[l].length &gt; 0) {&#xd;
			temp2.push(palavras2[l]);&#xd;
		}&#xd;
	}&#xd;
	palavras2 = temp2;&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isMesmaPessoa() - palavras1/palavras2: &quot;+palavras1+&apos;/&apos;+palavras2);&#xd;
	if (palavras1.length == 0 || palavras2.length == 0) return false;&#xd;
	&#xd;
	// Verificar se o primeiro nome é o mesmo&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isMesmaPessoa() - palavras1[0]/palavras2[0]: &quot;+palavras1[0]+&apos;/&apos;+palavras2[0]);&#xd;
	if (palavras1[0] !== palavras2[0]) return false;&#xd;
	&#xd;
	// Verificar se o último sobrenome é o mesmo (importante para identificação)&#xd;
	var ultimoSobrenome1 = palavras1[palavras1.length - 1];&#xd;
	var ultimoSobrenome2 = palavras2[palavras2.length - 1];&#xd;
	log.info(&quot;### AprovacaoUnificada.serviceTask13 - isMesmaPessoa() - ultimoSobrenome1/ultimoSobrenome2: &quot;+ultimoSobrenome1+&apos;/&apos;+ultimoSobrenome2);&#xd;
	if (ultimoSobrenome1 !== ultimoSobrenome2) return false;&#xd;
	&#xd;
	// Se chegou até aqui, primeiro nome e último sobrenome são iguais&#xd;
	// Verificar se as palavras do nome menor estão contidas no nome maior&#xd;
	var nomeCompleto, nomeSimples;&#xd;
	if (palavras1.length &lt;= palavras2.length) {&#xd;
		nomeSimples = palavras1;&#xd;
		nomeCompleto = palavras2;&#xd;
	} else {&#xd;
		nomeSimples = palavras2;&#xd;
		nomeCompleto = palavras1;&#xd;
	}&#xd;
	&#xd;
	// Verificar se todas as palavras do nome simples estão no nome completo&#xd;
	for (var i = 0; i &lt; nomeSimples.length; i++) {&#xd;
		log.info(&quot;### AprovacaoUnificada.serviceTask13 - isMesmaPessoa() - nomeSimples[i]/nomeCompleto: &quot;+nomeSimples[i]+&apos;/&apos;+nomeCompleto);&#xd;
		var encontrou = false;&#xd;
		for (var j = 0; j &lt; nomeCompleto.length; j++) {&#xd;
			if (nomeSimples[i] === nomeCompleto[j]) {&#xd;
				encontrou = true;&#xd;
				break;&#xd;
			}&#xd;
		}&#xd;
		if (!encontrou) return false;&#xd;
	}&#xd;
	&#xd;
	return true;&#xd;
}&#xd;
&#xd;
// FUNCAO PARA SUBSTITUIR TODOS OS CARACTERES DE UMA STRING&#xd;
function replaceAll(str, de, para){&#xd;
    var pos = str.indexOf(de);&#xd;
    while (pos &gt; -1){&#xd;
		str = str.replace(de, para);&#xd;
		pos = str.indexOf(de);&#xd;
	}&#xd;
    return (str);&#xd;
}&#xd;
&#xd;
function obterCotacaoMoedasBancoCentral(moeda, dataCotacao, callback) {&#xd;
	// Formata a data para o formato MM-dd-yyyy 04-08-2025&#xd;
	var dataAtual = new Date();&#xd;
	var dia = ( dataAtual.getDate()       &lt; 10 ? &apos;0&apos; : &apos;&apos;) +  dataAtual.getDate();&#xd;
	var mes = ((dataAtual.getMonth() + 1) &lt; 10 ? &apos;0&apos; : &apos;&apos;) + (dataAtual.getMonth() + 1); // Janeiro é 0&#xd;
	var ano = dataAtual.getFullYear();&#xd;
	var dataFormatada = dataCotacao || &apos;&apos;+mes + &apos;-&apos; + dia + &apos;-&apos; + ano;&#xd;
	&#xd;
	// URL da API do Banco Central&#xd;
	//         &#xd;
	// DOLAR e SAR&#xd;
	// https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/CotacaoDolarDia(dataCotacao=@dataCotacao)?@dataCotacao=&apos;08-04-2025&apos;&amp;$top=100&amp;$format=json&amp;$select=cotacaoCompra&#xd;
	//&#xd;
	// EURO&#xd;
	// https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/CotacaoMoedaPeriodo(moeda=@moeda,dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?@moeda=&apos;EUR&apos;&amp;@dataInicial=&apos;04-22-2025&apos;&amp;@dataFinalCotacao=&apos;04-22-2025&apos;&amp;$top=1&amp;$format=json&amp;$select=cotacaoCompra&#xd;
	&#xd;
	// EUA e SAR&#xd;
	var url = &quot;https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/CotacaoDolarDia(dataCotacao=@dataCotacao)?@dataCotacao=&apos;&quot; + dataFormatada + &quot;&apos;&amp;$top=100&amp;$format=json&amp;$select=cotacaoCompra&quot;;&#xd;
	if(moeda==&apos;EUR&apos;)&#xd;
		url = &quot;https://olinda.bcb.gov.br/olinda/servico/PTAX/versao/v1/odata/CotacaoMoedaPeriodo(moeda=@moeda,dataInicial=@dataInicial,dataFinalCotacao=@dataFinalCotacao)?@moeda=&apos;EUR&apos;&amp;@dataInicial=&apos;&quot; + dataFormatada + &quot;&apos;&amp;@dataFinalCotacao=&apos;&quot; + dataFormatada + &quot;&apos;&amp;$top=1&amp;$format=json&amp;$select=cotacaoCompra&quot;;&#xd;
	&#xd;
	log.info(&quot;### cotacao dolar/euro banco central - endPoint:&quot;);&#xd;
	log.dir(url);&#xd;
	&#xd;
    try {&#xd;
        // Faz a requisição HTTP usando HttpURLConnection&#xd;
        var URL = new java.net.URL(url);&#xd;
        var connection = URL.openConnection();&#xd;
        connection.setRequestMethod(&quot;GET&quot;);&#xd;
        connection.setRequestProperty(&quot;Content-Type&quot;, &quot;application/json&quot;);&#xd;
        connection.connect();&#xd;
&#xd;
        var responseCode = connection.getResponseCode();&#xd;
        if (responseCode === 200) {&#xd;
            var scanner = new java.util.Scanner(connection.getInputStream());&#xd;
            var response = &quot;&quot;;&#xd;
            while (scanner.hasNext()) {&#xd;
                response += scanner.nextLine();&#xd;
            }&#xd;
            scanner.close();&#xd;
&#xd;
            // Parseia a resposta JSON&#xd;
            var jsonResponse = JSON.parse(response);&#xd;
&#xd;
            // Verifica se há valores retornados&#xd;
            if (jsonResponse.value &amp;&amp; jsonResponse.value.length &gt; 0) {&#xd;
                callback(null, jsonResponse.value[0].cotacaoCompra); // Retorna a cotação de compra&#xd;
            } else {&#xd;
				// SE NAO ENCONTRAR VALOR LANCAR CONF VALORES FIXOS INFORMADOS PELA GESTAO DE BUSINESS CONTROL&#xd;
            	// MAIO.25 &#xd;
            	// usd = R$5,66 &#xd;
            	// JPY = R$0,04 &#xd;
            	// SAR = R$1,51 &#xd;
            	// EUR = R$6,42&#xd;
           		callback(null, valorPadrao(moeda));&#xd;
            }&#xd;
        } else {&#xd;
       		callback(null, valorPadrao(moeda));&#xd;
            // callback(&quot;### Falha ao acessar a API do Banco Central: &quot; + responseCode, null);&#xd;
        }&#xd;
    } catch (error) {&#xd;
   		callback(null, valorPadrao(moeda));&#xd;
        // callback(&quot;### Falha ao obter a cotação do dólar do Banco Central: &quot; + error+&apos; --- &apos;+url, null);&#xd;
    }&#xd;
}&#xd;
&#xd;
function valorPadrao(qMOEDA){&#xd;
	if(qMOEDA==&apos;USD&apos;)&#xd;
		return 5.66;&#xd;
	&#xd;
	else if(qMOEDA==&apos;JPY&apos;)&#xd;
		return 0.04;&#xd;
&#xd;
	else if(qMOEDA==&apos;SAR&apos;)&#xd;
		return 1.51;&#xd;
&#xd;
	else if(qMOEDA==&apos;EUR&apos;)&#xd;
		return 6.42;&#xd;
	&#xd;
	else if(qMOEDA==&apos;LIB&apos;)&#xd;
		return 7.24&#xd;
	&#xd;
	else return 1;&#xd;
}&#xd;
&#xd;
function parseValorMonetario(valor) {&#xd;
    if (valor === null || valor === &apos;&apos;) return 0; // Verificação mais robusta&#xd;
&#xd;
    var valorStr = String(valor); // Garante que estamos trabalhando com uma string&#xd;
&#xd;
    // Etapa 1: Remover símbolos de moeda e espaços&#xd;
    var simbolosMoeda = [&quot;R$&quot;, &quot;US$&quot;, &quot;€&quot;, &quot;﷼&quot;, &quot;£&quot;];&#xd;
    // Substituindo forEach por um loop for padrão&#xd;
    for (var i = 0; i &lt; simbolosMoeda.length; i++) {&#xd;
        var simbolo = simbolosMoeda[i];&#xd;
        // Usar split/join para simular replaceAll e evitar problemas com regex no Fluig/Rhino&#xd;
        // É importante que &apos;simbolo&apos; não contenha caracteres especiais de regex se fosse usar replace com regex.&#xd;
        // Com split/join, ele é tratado literalmente.&#xd;
        if (valorStr.indexOf(simbolo) !== -1) { // Otimização: só fazer split/join se o símbolo existir&#xd;
            valorStr = valorStr.split(simbolo).join(&quot;&quot;);&#xd;
        }&#xd;
    }&#xd;
&#xd;
    // Remover espaços. A regex original /s cobria todos os tipos de whitespace.&#xd;
    // split(&quot; &quot;).join(&quot;&quot;) só remove espaços literais (&apos; &apos;).&#xd;
    // Se outros caracteres de espaço em branco (como tabulações) precisarem ser removidos,&#xd;
    // esta parte pode precisar de ajustes adicionais (ex: valorStr = valorStr.split(&quot;\t&quot;).join(&quot;&quot;);)&#xd;
    valorStr = valorStr.split(&quot; &quot;).join(&quot;&quot;);&#xd;
&#xd;
    // Etapa 2: Remover pontos (usados como separadores de milhar)&#xd;
    valorStr = valorStr.split(&quot;.&quot;).join(&quot;&quot;);&#xd;
&#xd;
    // Etapa 3: Substituir vírgula (usada como separador decimal) por ponto&#xd;
    valorStr = valorStr.replace(&quot;,&quot;, &quot;.&quot;);&#xd;
&#xd;
    var resultado = parseFloat(valorStr);&#xd;
    &#xd;
    // Retorna 0 se o resultado não for um número (ex: se a string original era inválida)&#xd;
    return isNaN(resultado) ? 0 : resultado;&#xd;
}&#xd;
&#xd;
function isTrue(valor) {&#xd;
    if (valor === true) return true;&#xd;
    if (typeof valor === &apos;string&apos;) {&#xd;
        var v = valor.trim().toLowerCase();&#xd;
        return v === &apos;true&apos; || v === &apos;sim&apos; || v === &apos;s&apos; || v === &apos;on&apos;;&#xd;
    }&#xd;
    return false;&#xd;
}&#xd;
&#xd;
var MOEDAS = {&#xd;
    &apos;US$&apos;: &apos;USD&apos;,&#xd;
    &apos;€&apos;  : &apos;EUR&apos;,&#xd;
    &apos;﷼&apos;  : &apos;SAR&apos;,&#xd;
    &apos;R$&apos; : &apos;REAL&apos;,&#xd;
    &apos;£&apos;  : &apos;LIB&apos;&#xd;
};&#xd;
&#xd;
function getMoeda(valor) {&#xd;
    for (var simbolo in MOEDAS) {&#xd;
        if (valor.indexOf(simbolo) !== -1) return MOEDAS[simbolo];&#xd;
    }&#xd;
    return &apos;Real&apos;;&#xd;
}&#xd;
&#xd;
function buscarDataset(nome, constraints) {&#xd;
    var ds = DatasetFactory.getDataset(nome, null, constraints, null);&#xd;
    return ds;&#xd;
}&#xd;
</eventDescription>
    </WorkflowProcessEvent>
    <WorkflowProcessEvent>
      <workflowProcessEventPK>
        <companyId>1</companyId>
        <eventId>servicetask35</eventId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
      </workflowProcessEventPK>
      <eventDescription>function servicetask35(attempt, message) {&#xd;
	// CONFIRMAR SE O BANCO DE DADOS LIBEROU O COMMIT DO FORM ANTES DE TESTAR A VALIDACAO&#xd;
	// FAZER 3 TENTATIVAS A CADA 2 MINUTOS&#xd;
	var numChamado = hAPI.getCardValue(&quot;numChamado&quot;);&#xd;
	var usuario    = getValue(&apos;WKUser&apos;); //matricula do usuário corrente&#xd;
&#xd;
	// Verifica se o usuário atual é o responsável pela aprovação&#xd;
	log.info(&quot;### AprovacaoUnificada.servicetask36 - numChamado: &quot;+numChamado);&#xd;
	log.info(&quot;### AprovacaoUnificada.servicetask36 - usuario: &quot;+usuario);&#xd;
&#xd;
	var params = new Array();&#xd;
		params.push( DatasetFactory.createConstraint(&quot;numChamado&quot;,numChamado,&apos;&apos;,ConstraintType.MUST) );&#xd;
	var dsExecutados = DatasetFactory.getDataset(&quot;DS_ALCADAS_EXECUTADAS&quot;,null,params,null);&#xd;
	log.info(&quot;### AprovacaoUnificada.servicetask36 - DS_ALCADAS_EXECUTADAS&quot;);&#xd;
	log.dir(dsExecutados);&#xd;
	&#xd;
	var achei=&apos;nao&apos;;&#xd;
	if(dsExecutados.rowsCount &gt; 0)&#xd;
		for (var i1 = 0; i1 &lt; dsExecutados.rowsCount; i1++) {&#xd;
			var status = &apos;&apos;+dsExecutados.getValue(i1, &quot;apvStatus&quot;);&#xd;
			if(status ==&apos;nao_confirmado&apos;){&#xd;
				achei=&apos;sim&apos;;&#xd;
				break;&#xd;
			}&#xd;
		}&#xd;
	else &#xd;
		achei=&apos;vazio&apos;;&#xd;
	&#xd;
	log.info(&quot;### AprovacaoUnificada.servicetask36 - achei: &quot;+achei);&#xd;
	return achei;&#xd;
}&#xd;
</eventDescription>
    </WorkflowProcessEvent>
    <WorkflowProcessEvent>
      <workflowProcessEventPK>
        <companyId>1</companyId>
        <eventId>beforeCancelProcess</eventId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
      </workflowProcessEventPK>
      <eventDescription>function beforeCancelProcess(colleagueId,processId){&#xd;
	// VERIFICAR SE O WF PAI STATUS DIFERENTE DE 0 - ATIVO&#xd;
	var params = new Array();&#xd;
		params.push( DatasetFactory.createConstraint(&quot;wfFILHO&quot;,processId,processId,ConstraintType.MUST) );&#xd;
	var dsWF = DatasetFactory.getDataset(&quot;dsStatusPai_SubProcesso&quot;,null,params,null);&#xd;
	if(dsWF.values.length &gt; 0)&#xd;
		if(colleagueId!=dsWF.getValue(0,&apos;COD_MATR_REQUISIT&apos;)){&#xd;
    		/** STATUS &#xd;
    		 * when 0 then Aberto&#xd;
    		 * when 1 then Cancelado &#xd;
    		 * when 2 then Finalizado&#xd;
    		 */&#xd;
    	    var status = parseInt(dsWF.getValue(0,&quot;STATUS&quot;)); &#xd;
    	    if(status!=1){&#xd;
    	    	log.info(&apos;### wfTermos.beforeCancelProcess - Cancelamento do WF/Solicitação de Subprocesso não é permitido. Será necessário cancelar o WF de Origem&apos;);&#xd;
    	    	throw &quot;CANCELAMENTO DO WF/SOLICITAÇÃO DE SUBPROCESSO NÃO É PERMITIDO. SERÁ NECESSÁRIO CANCELAR O WF DE ORIGEM&quot;;&#xd;
    	    }&#xd;
    	}&#xd;
}&#xd;
</eventDescription>
    </WorkflowProcessEvent>
    <WorkflowProcessEvent>
      <workflowProcessEventPK>
        <companyId>1</companyId>
        <eventId>verNivelAPV</eventId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
      </workflowProcessEventPK>
      <eventDescription>function verificaUltimoAprovador(){&#xd;
	// VERIFICA SE O ULTIMO APROVADOR EXECTOU A APROVACAO SIM = TRUE OU NAO = FALSE NA TABELA targetAprovadores&#xd;
   	var nomeTabela   = &quot;targetAprovadores&quot;;&#xd;
   	var numeroLinhas = hAPI.getChildrenIndexes(nomeTabela);&#xd;
	if (numeroLinhas.length === 0) {&#xd;
		log.info(&quot;### verificaUltimoAprovador: Nenhuma linha encontrada na tabela targetAprovadores.&quot;);&#xd;
		return false;&#xd;
	}&#xd;
	var indice       = numeroLinhas[ numeroLinhas.length-1 ];&#xd;
	var solicitacao  = hAPI.getCardValue(&quot;numChamado&quot;);&#xd;
	&#xd;
	log.info(&quot;### verificaUltimoAprovador:&quot;+solicitacao);&#xd;
	log.info(&quot;### verificaUltimoAprovador 0- &quot;+numeroLinhas);&#xd;
	log.dir(numeroLinhas);&#xd;
	log.info(&quot;### verificaUltimoAprovador 1- &quot;+numeroLinhas[indice]);&#xd;
	log.info(&quot;### verificaUltimoAprovador 2- &quot;+indice);&#xd;
	&#xd;
	// Pegue os valores de cada coluna&#xd;
	var campo1 = hAPI.getCardValue(&quot;apvStatus___&quot; + indice);&#xd;
	if(campo1==undefined || campo1==null || campo1==&apos;&apos;)&#xd;
		return &apos;Erro&apos;;&#xd;
&#xd;
	log.info(&quot;### verificaUltimoAprovador 3- &quot;+campo1);&#xd;
&#xd;
	// Verifique se o campo é igual a &quot;Aprovado&quot; ou &quot;Reprovado&quot;&#xd;
	if(campo1 == &quot;Aprovado&quot; || campo1==&quot;Reprovado&quot;)&#xd;
		return &apos;sim&apos;;&#xd;
	else&#xd;
		return &apos;nao&apos;;&#xd;
}&#xd;
&#xd;
function verificaSeCargaAprovadores(){&#xd;
	// CONFIRMAR SE A TABELA DE APROVADORES FOI CARREGADA COM SUSCESSO&#xd;
   	// Identifique o nome do campo da tabela pai-filho&#xd;
   	var nomeTabela = &quot;targetAprovadores&quot;;&#xd;
&#xd;
   	// Obtenha o número de linhas da tabela&#xd;
   	var numeroLinhas = hAPI.getChildrenIndexes(nomeTabela);&#xd;
   	if(numeroLinhas.length&lt;=0)&#xd;
   		return false;&#xd;
   	else&#xd;
   		return true;&#xd;
}&#xd;
</eventDescription>
    </WorkflowProcessEvent>
    <WorkflowProcessEvent>
      <workflowProcessEventPK>
        <companyId>1</companyId>
        <eventId>afterTaskCreate</eventId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
      </workflowProcessEventPK>
      <eventDescription>function afterTaskCreate(colleagueId){&#xd;
    var numChamado = getValue(&quot;WKNumProces&quot;);&#xd;
    hAPI.setCardValue(&apos;numChamado&apos;,numChamado);&#xd;
&#xd;
    if(hAPI.getCardValue(&apos;dtAberturaChamado&apos;)==&apos;&apos;){&#xd;
    	var xDT = new Date().toLocaleDateString();&#xd;
    	hAPI.setCardValue(&apos;dtAberturaChamado&apos;,xDT);&#xd;
    }&#xd;
    &#xd;
    if(	hAPI.getCardValue(&apos;nomeSolicitante&apos;)==&apos;&apos;){&#xd;
    	var usuario   = hAPI.getCardValue(&apos;codSolicitante&apos;);&#xd;
    	var const1    = DatasetFactory.createConstraint(&quot;colleaguePK.colleagueId&quot;,usuario,usuario,ConstraintType.MUST);&#xd;
    	var dsUSU     = DatasetFactory.getDataset(&quot;colleague&quot;, null,[ const1 ], null);&#xd;
    	hAPI.setCardValue(&apos;nomeSolicitante&apos; ,dsUSU.getValue(0,&apos;colleagueName&apos;));&#xd;
    	hAPI.setCardValue(&apos;emailSolicitante&apos;,dsUSU.getValue(0,&apos;mail&apos;));&#xd;
    }&#xd;
}&#xd;
</eventDescription>
    </WorkflowProcessEvent>
  </list>
  <list/>
  <list>
    <SwimLane>
      <color>C0C0C0</color>
      <height>401</height>
      <width>1021</width>
      <positionX>210</positionX>
      <positionY>0</positionY>
      <stateName></stateName>
      <type>2</type>
      <parentSequence>0</parentSequence>
      <swimLanePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>1</sequence>
      </swimLanePK>
    </SwimLane>
    <SwimLane>
      <color>FF8040</color>
      <height>400</height>
      <width>31</width>
      <positionX>170</positionX>
      <positionY>0</positionY>
      <stateName>Aprovação Unificada 24-25</stateName>
      <type>1</type>
      <parentSequence>0</parentSequence>
      <swimLanePK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <sequence>2</sequence>
      </swimLanePK>
    </SwimLane>
  </list>
  <list>
    <ProcessComponGraf>
      <componType>1</componType>
      <positionX>1250</positionX>
      <positionY>0</positionY>
      <processComponGrafPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <componGrafSequence>44</componGrafSequence>
      </processComponGrafPK>
      <stateName>Revisada 14.08.25 NFSe</stateName>
    </ProcessComponGraf>
    <ProcessComponGraf>
      <componType>1</componType>
      <positionX>1250</positionX>
      <positionY>69</positionY>
      <processComponGrafPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <componGrafSequence>51</componGrafSequence>
      </processComponGrafPK>
      <stateName>Revisada 14.08.25 RA</stateName>
    </ProcessComponGraf>
    <ProcessComponGraf>
      <componType>1</componType>
      <positionX>1250</positionX>
      <positionY>140</positionY>
      <processComponGrafPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <componGrafSequence>52</componGrafSequence>
      </processComponGrafPK>
      <stateName>Revisada 01.09.25 Aprovador x Solicitante</stateName>
    </ProcessComponGraf>
    <ProcessComponGraf>
      <componType>1</componType>
      <positionX>1250</positionX>
      <positionY>240</positionY>
      <processComponGrafPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>1</version>
        <componGrafSequence>53</componGrafSequence>
      </processComponGrafPK>
      <stateName>Revisada 06.09.25 Libra </stateName>
    </ProcessComponGraf>
  </list>
  <list/>
  <list>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>9</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>1017</positionX>
      <positionY>16</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>9</linkSequence>
        <bendSequence>2</bendSequence>
      </processLinkBendPK>
      <positionX>683</positionX>
      <positionY>16</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>23</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>539</positionX>
      <positionY>283</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>29</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>1192</positionX>
      <positionY>282</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>30</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>682</positionX>
      <positionY>282</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>31</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>1018</positionX>
      <positionY>282</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>34</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>862</positionX>
      <positionY>385</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>34</linkSequence>
        <bendSequence>2</bendSequence>
      </processLinkBendPK>
      <positionX>373</positionX>
      <positionY>385</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>41</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>763</positionX>
      <positionY>282</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>41</linkSequence>
        <bendSequence>2</bendSequence>
      </processLinkBendPK>
      <positionX>763</positionX>
      <positionY>97</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>50</linkSequence>
        <bendSequence>1</bendSequence>
      </processLinkBendPK>
      <positionX>682</positionX>
      <positionY>25</positionY>
    </ProcessLinkBend>
    <ProcessLinkBend>
      <processLinkBendPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <version>119</version>
        <linkSequence>50</linkSequence>
        <bendSequence>2</bendSequence>
      </processLinkBendPK>
      <positionX>373</positionX>
      <positionY>25</positionY>
    </ProcessLinkBend>
  </list>
  <list/>
  <list/>
  <list>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>area</fieldId>
      </processFormFieldPK>
      <fieldDescription>Área </fieldDescription>
      <slotId>1</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>centroCusto</fieldId>
      </processFormFieldPK>
      <fieldDescription>Centro de Custo</fieldDescription>
      <slotId>2</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>classeValor</fieldId>
      </processFormFieldPK>
      <fieldDescription>Classe de Valor</fieldDescription>
      <slotId>3</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>filial</fieldId>
      </processFormFieldPK>
      <fieldDescription>Filial</fieldDescription>
      <slotId>4</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>nomeSolicitante</fieldId>
      </processFormFieldPK>
      <fieldDescription>Solicitante</fieldDescription>
      <slotId>5</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>numChamado</fieldId>
      </processFormFieldPK>
      <fieldDescription>Chamado</fieldDescription>
      <slotId>6</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>numChamadoOrigem</fieldId>
      </processFormFieldPK>
      <fieldDescription>Chamado de Origem</fieldDescription>
      <slotId>7</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>operacao</fieldId>
      </processFormFieldPK>
      <fieldDescription>Operação</fieldDescription>
      <slotId>8</slotId>
    </ProcessFormField>
    <ProcessFormField>
      <processFormFieldPK>
        <companyId>1</companyId>
        <processId>wfAprovacaoUnificada</processId>
        <fieldId>valorSolicitado</fieldId>
      </processFormFieldPK>
      <fieldDescription>Valor</fieldDescription>
      <slotId>9</slotId>
    </ProcessFormField>
  </list>
  <list>
    <ProcessStateService>
      <companyId>1</companyId>
      <processId>wfAprovacaoUnificada</processId>
      <version>1</version>
      <sequence>13</sequence>
      <attempts>0</attempts>
      <sucessFullMessage>Carga de Aprovadores Executada com Sucesso</sucessFullMessage>
      <serviceName></serviceName>
      <frequency>1</frequency>
      <frequencyType>0</frequencyType>
    </ProcessStateService>
    <ProcessStateService>
      <companyId>1</companyId>
      <processId>wfAprovacaoUnificada</processId>
      <version>1</version>
      <sequence>35</sequence>
      <attempts>2</attempts>
      <sucessFullMessage>Documento verificado com sucesso</sucessFullMessage>
      <serviceName></serviceName>
      <frequency>2</frequency>
      <frequencyType>0</frequencyType>
    </ProcessStateService>
  </list>
  <list/>
  <list/>
  <list/>
  <list/>
</list>